<!-- Copyright (c) Microsoft Corporation. All rights reserved. -->
<html dir="LTR">
<head>
	<title>ATL 简单对象向导</title>
	<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	<meta http-equiv="MSThemeCompatible" content="Yes">
	<link id="LINKURL" rel="stylesheet" href="../../../../../2052/NewStyles.css">
</head>
<body bgcolor="BUTTONFACE" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"
	onload="InitDocument(document);" onkeydown="OnKey();" onkeypress="OnPress();">
	<table class="ONE" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
		<col class="LinkPane">
		<col>
		<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
		<tr valign="TOP">
			<td height="79" width="100%" colspan="2">
				<table class="TWO" border="0" cellpadding="0" cellspacing="0">
					<col width="12">
					<col>
					<col width="12">
					<tr>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td class="IMAGE" valign="BOTTOM" width="110" rowspan="2">
							<div class="SMALLA" id="Layer0">
								<img class="SMALLEST" src="../../Images/ATL_Simple.gif" width="63" height="63" alt=""
									border="0">
							</div>
						</td>
						<td valign="TOP" height="12" width="6" rowspan="2">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="65">
							<h4 class="HEAD" id="HEAD">文件类型处理程序选项</h4>
							<p class="SUBHEAD" id="SUBHEAD">
								指定处理程序类型、文档和视图派生类名称及其头文件。</p>
						</td>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" class="RULE" colspan="5" height="2">
							<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
								<tr valign="TOP">
									<td height="1" width="100%" bgcolor="BUTTONSHADOW">
									</td>
									<td height="1" width="1" bgcolor="WINDOW">
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
		<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
		<tr valign="TOP">
			<td class="Three" valign="TOP" height="100%" width="100%">
				<table class="fixedSize" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
					<tr valign="TOP">
						<td class="threeCustom" valign="TOP">
							<!--OPEN OF NAVIGATION TABLE//-->
							<table class="THREE" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="1">
								<tr>
									<td valign="TOP" colspan="3" height="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="100%">
										&nbsp;
									</td>
									<td valign="TOP" height="100%">
										<!--OPEN OF NAVIGATIONAL LINKS//-->
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="Default" title="指定类名和文件名。"
															onclick="Next(document, 'Default.htm');" tabindex="1">名称</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINKSELECTED">
											<span class="VERTLINE1">
												<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
											</span><span class="HORILINE1">
												<table width="167" height="100%" border="0" cellpadding="0" cellspacing="0">
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
													<tr valign="TOP">
														<td height="100%">
															<img src="../../../../../1033/Images/spacer.gif" width="1" height="28" alt="" border="0">
														</td>
													</tr>
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
												</table>
											</span>
											<table width="160" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXTSELECTED">
												<tr valign="MIDDLE">
													<td width="100%">
														<span id="Handler_Options" title="指定预览、缩略图和搜索处理程序选项。">
															文件类型选项</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="Options" title="指定要支持的线程模型、接口类型和任何附加接口。"
															onclick="Next(document, 'Options.htm');" tabindex="1">选项</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<!--CLOSE OF NAVIGATIONAL LINKS//-->
									</td>
									<td width="1">
										<div class="VERTLINE">
											<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
										</div>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION TABLE//-->
			</td>
			<td valign="TOP" height="100%">
				<!--OPEN OF CONTENT AND BUTTON TABLE//-->
				<table class="ONE" border="0" cellpadding="0" cellspacing="0">
					<col width="100%">
					<tr valign="TOP">
						<td height="100%">
							<!--OPEN OF CONTENT//-->
							<table class="CONTENT" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="12">
								<col>
								<col width="12">
								<tr>
									<td valign="TOP" height="12" colspan="5">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="22">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<span class="itemText" id="ADD_HANDLER_SUPPORT_TITLE" title="添加预览、缩略图或搜索的处理程序。">
											<input class="CheckBox" type="checkbox" id="ADD_HANDLER_SUPPORT" accesskey="a" tabindex="13"
												onpropertychange="OnHandlerSupportChanged();" tabindex="0">
											<div class="itemTextCheckboxA">
												<label for="ADD_HANDLER_SUPPORT" id="ADD_HANDLER_SUPPORT_LABEL">添加文件类型(预览/缩略图/搜索处理程序)支持(<u>A</u>)</label>
											</div>
										</span>
									</td>
								</tr>
								<tr>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<table class="FixedSize" border="0" cellpadding="0" cellspacing="0">
											<col width="193">
											<col width="12">
											<col width="185">
											<col width="8">
											<tr>
												<td valign="TOP">
													<span id="PREVIEW_HANDLER_TITLE" title="实现 IPreviewHandler 接口。">
														<input type="radio" class="radio" name="handler_type" id="PREVIEW_HANDLER" accesskey="P"
															onpropertychange="OnHandlerChange();" tabindex="1">
														<div class="itemTextRadioB">
															<label for="PREVIEW_HANDLER" id="PREVIEW_HANDLER_LABEL">预览处理程序(<u>P</u>)</label>
														</div>
													</span>
													<br>
													<span id="THUMBNAIL_PROVIDER_TITLE" title="实现 IThumbnailProvider 接口。">
														<input type="radio" class="radio" name="handler_type" id="THUMBNAIL_PROVIDER_HANDLER"
															accesskey="L" onpropertychange="OnHandlerChange();" tabindex="2">
														<div class="itemTextRadioB">
															<label for="THUMBNAIL_PROVIDER_HANDLER" id="THUMBNAIL_PROVIDER_HANDLER_LABEL">缩略图处理程序(<u>T</u>)</label>
														</div>
													</span>
													<br>
													<span id="SEARCH_HANDLER_TITLE" title="实现 IFilter 接口。">
														<input type="radio" class="radio" name="handler_type" id="SEARCH_HANDLER" accesskey="S"
															onpropertychange="OnHandlerChange();" tabindex="3">
														<div class="itemTextRadioB">
															<label for="SEARCH_HANDLER" id="SEARCH_HANDLER_LABEL">搜索处理程序(<u>S</u>)</label>
														</div>
													</span>
													<br>
													<br>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="HANDLER_FILE_EXTENSION_TITLE" title="已向预览/缩略图/搜索处理程序注册的文件扩展名。">
														<label for="HANDLER_FILE_EXTENSION" id="HANDLER_FILE_EXTENSION_LABEL">文件扩展名(<u>F</u>): </label>
														<br>
														<input class="sideBtn21" maxlength="256" type="text" id="HANDLER_FILE_EXTENSION"
															accesskey="F" tabindex="4">
													</span>
												</td>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
											</tr>
										</table>
										<td valign="TOP" width="12">
											&nbsp;
										</td>
								</tr>
								<tr>
									<td valign="TOP" height="4" colspan="5">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<table class="CONTENTLINE" border="0" cellpadding="0" cellspacing="0">
											<col>
											<col width="4">
											<col>
											<tr>
												<td valign="TOP" id="MFCSUPPORT_TD2">
													<nobr><strong>基于 ATL 的文档</strong></nobr>
												</td>
												<td valign="MIDDLE" width="4">
													&nbsp;
												</td>
												<td valign="MIDDLE" width="100%">
													<table class="CONTENTLINE1" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td valign="MIDDLE" width="100%">
																<div class="InLineA">
																</div>
																<div class="InLineB">
																</div>
															</td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
									</td>
									<td valign="TOP">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="9" colspan="3">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<table class="FixedSize" border="0" cellpadding="0" cellspacing="0">
											<col width="8">
											<col width="185">
											<col width="12">
											<col width="185">
											<col width="8">
											<tr>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="HANDLER_ATL_DOC_CLASS_NAME_TITLE" title="用于保存数据的泛型文档类的名称。在此处，您可以指定现有或新文档类的名称。如果尚未创建此类，请选中“生成基于 ATL 的文档”复选框。">
														<label for="HANDLER_ATL_DOC_CLASS_NAME" id="HANDLER_ATL_DOC_CLASS_NAME_LABEL">泛型文档类名称(<u>G</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" id="HANDLER_ATL_DOC_CLASS_NAME"
															accesskey="G" onpropertychange="OnATLDocClassName();" tabindex="6">
													</span>
													<p class="ElementSpacer2">
														&nbsp;</p>
													<span id="GEN_ATL_DOC_TITLE" title="生成基于 ATL 的文档。您可以为所有处理程序生成一个文档类。">
														<input type="checkbox" class="checkbox" id="HANDLER_GEN_ATL_DOC" accesskey="A" onpropertychange="OnGenATLDocChange();"
															tabindex="5">
														<div class="itemTextCheckboxB">
															<label for="HANDLER_GEN_ATL_DOC" id="HANDLER_GEN_ATL_DOC_LABEL">生成基于 ATL 的文档(<u>A</u>)</label>
														</div>
													</span>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="HANDLER_ATL_DOC_HEADER_FILE_TITLE" title="定义泛型文档类的头文件。">
														<label for="HANDLER_ATL_DOC_HEADER_FILE" id="HANDLER_ATL_DOC_HEADER_FILE_LABEL">泛型文档的 .h(<u>H</u>): </label>
														<br>
														<input class="sideBtn21" maxlength="256" type="text" id="HANDLER_ATL_DOC_HEADER_FILE"
															accesskey="h" tabindex="9">
														<button class="buttonClass3Custom" id="BrowseATLDocumentHeader" accesskey="" type="BUTTON"
															title="浏览文档头文件" onclick="OnBrowseHeaderFile(HANDLER_ATL_DOC_HEADER_FILE);" tabindex="10">
															...</button>
													</span>
													<p class="ElementSpacer2">
														&nbsp;</p>
													<span class="itemText" id="HANDLER_ATL_DOC_IMPL_FILE_TITLE" title="实现泛型文档类的文件。">
														<label for="HANDLER_ATL_DOC_IMPL_FILE" id="HANDLER_ATL_DOC_IMPL_FILE_LABEL">泛型文档的 .cpp(<u>O</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" id="HANDLER_ATL_DOC_IMPL_FILE"
															accesskey="o" tabindex="7">
													</span>
												</td>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
											</tr>
										</table>
									</td>
									<td valign="TOP">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="4" colspan="5">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<table class="CONTENTLINE" border="0" cellpadding="0" cellspacing="0">
											<col>
											<col width="4">
											<col>
											<tr>
												<td valign="TOP" id="MFCSUPPORT_TD">
													<nobr><B>基于 MFC 的文档(和视图)</B></nobr>
												</td>
												<td valign="MIDDLE" width="4">
													&nbsp;
												</td>
												<td valign="MIDDLE" width="100%">
													<table class="CONTENTLINE1" border="0" cellpadding="0" cellspacing="0">
														<tr>
															<td valign="MIDDLE" width="100%">
																<div class="InLineA">
																</div>
																<div class="InLineB">
																</div>
															</td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
									</td>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="9" colspan="3">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP" colspan="3">
										<table class="FixedSize" border="0" cellpadding="0" cellspacing="0">
											<col width="8">
											<col width="185">
											<col width="12">
											<col width="185">
											<col width="8">
											<tr>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="HANDLER_DOCUMENT_NAME_TITLE" title="用于保存数据的 CDocument 派生类的名称。">
														<label for="HANDLER_DOCUMENT_NAME" id="HANDLER_DOCUMENT_NAME_LABEL">文档类名称(<u>D</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" id="HANDLER_DOCUMENT_NAME" accesskey="D"
															onpropertychange="OnMFCDocClassName();" tabindex="11">
													</span>
													<p class="ElementSpacer2">
														&nbsp;</p>
													<span class="itemText" id="HANDLER_VIEW_NAME_TITLE" title="用于在大预览视图中显示数据的 CView 派生类的名称。">
														<label for="HANDLER_VIEW_NAME" id="HANDLER_VIEW_NAME_LABEL">视图类名称(<u>V</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" id="HANDLER_VIEW_NAME" accesskey="V"
															onpropertychange="OnMFCViewClassName();" tabindex="12">
													</span>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="HANDLER_DOCUMENT_FILE_NAME_TITLE" title="定义文档类的头文件。">
														<label for="HANDLER_DOCUMENT_FILE_NAME" id="HANDLER_DOCUMENT_FILE_NAME_LABEL">MFC 文档的 .h(<u>C</u>): </label>
														<br>
														<input class="sideBtn21" maxlength="256" type="text" id="HANDLER_DOCUMENT_FILE_NAME"
															accesskey="c" tabindex="13">
														<button class="buttonClass3Custom" id="BrowseBtnHeaderDoc" accesskey="" type="BUTTON"
															title="浏览文档头文件" onclick="OnBrowseHeaderFile(HANDLER_DOCUMENT_FILE_NAME);" tabindex="14">
															...</button>
													</span>
													<p class="ElementSpacer2">
														&nbsp;</p>
													<span class="itemText" id="HANDLER_VIEW_FILE_NAME_TITLE" title="定义视图类的头文件。">
														<label for="HANDLER_VIEW_FILE_NAME" id="HANDLER_VIEW_FILE_NAME_LABEL">视图的 .h(<u>I</u>): </label>
														<br>
														<input class="sideBtn21" maxlength="256" type="text" id="HANDLER_VIEW_FILE_NAME"
															accesskey="i" tabindex="15">
														<button class="buttonClass3Custom" id="BrowseBtnHeaderView" accesskey="" type="BUTTON"
															title="浏览视图头文件" onclick="OnBrowseHeaderFile(HANDLER_VIEW_FILE_NAME);" tabindex="16">
															...</button>
													</span>
												</td>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
											</tr>
										</table>
									</td>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
								</tr>
							</table>
							<!--CLOSE OF CONTENT//-->
						</td>
					</tr>
					<tr valign="BOTTOM">
						<td>
							<!--OPEN OF BUTTON HTML//-->
							<table border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="12">
								<tr>
									<td valign="TOP" class="RULE" colspan="8" height="2">
										<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
											<tr valign="TOP">
												<td height="1" width="100%" bgcolor="BUTTONSHADOW">
												</td>
												<td height="1" width="1" bgcolor="WINDOW">
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="11" colspan="8">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
									<td valign="TOP" height="23">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="FinishBtn" onclick="OnFinish(document);">
											完成</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="CancelBtn" onclick="window.external.Finish(document, 'cancel');">
											取消</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="HelpBtn" onclick="window.external.OnHelp('vc.codewiz.class.atl.simple.options');">
											帮助</button>
									</td>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="12" colspan="8">
										&nbsp;
									</td>
								</tr>
							</table>
							<!--CLOSE OF BUTTON HTML//-->
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
			</td>
		</tr>
	</table>
</body>
</html>

<script language="JSCRIPT">

	var tab_array = new Array();
	tab_array[0] = Default;
	tab_array[1] = Handler_Options;
	tab_array[2] = Options;

	var isMFCProject = false;

	function InitDocument(document) {
		isMFCProject = IsMFCProject(window.external.ProjectObject, false);
		setDirection();

		if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD")) {
			window.external.SetDefaults(document);
		}

		window.external.Load(document);

		OnHandlerSupportChanged();
		OnGenATLDocChange();
	}

	function Next(document, linkto) {
		if (!SetAndValidate())
			return;

		window.external.Next(document, linkto);
	}

	function OnFinish(document) {
		if (!SetAndValidate())
			return;

		OnWizFinish(document);
	}

	function OnHandlerSupportChanged() {
		if (ADD_HANDLER_SUPPORT.checked) {
			SEARCH_HANDLER.disabled = false;
			SEARCH_HANDLER_LABEL.disabled = false;
			PREVIEW_HANDLER.disabled = false;
			PREVIEW_HANDLER_LABEL.disabled = false;
			THUMBNAIL_PROVIDER_HANDLER.disabled = false;
			THUMBNAIL_PROVIDER_HANDLER_LABEL.disabled = false;
			HANDLER_GEN_ATL_DOC.disabled = false;
			HANDLER_GEN_ATL_DOC_LABEL.disabled = false;
			HANDLER_FILE_EXTENSION.disabled = false;
			HANDLER_FILE_EXTENSION_LABEL.disabled = false;

			window.external.AddSymbol("AUTOMATION", false);
			window.external.AddSymbol("AGGREGATION_YES", false);
			window.external.AddSymbol("AGGREGATION_NO", true);
			window.external.AddSymbol("AGGREGATION_ONLY", false);
			window.external.AddSymbol("INTERFACE_DUAL", false);
			window.external.AddSymbol("INTERFACE_CUSTOM", true);

			window.external.AddSymbol("THREADING_SINGLE", false);
			if (SEARCH_HANDLER.checked) {
				window.external.AddSymbol("THREADING_APARTMENT", false);
				window.external.AddSymbol("THREADING_BOTH", true);
			}
			else {
				window.external.AddSymbol("THREADING_APARTMENT", true);
				window.external.AddSymbol("THREADING_BOTH", false);
			}
			window.external.AddSymbol("THREADING_FREE", false);
			window.external.AddSymbol("THREADING_NEUTRAL", false);

			OnHandlerChange();
			OnMFCDocClassName();
			OnMFCViewClassName()
			OnATLDocClassName();
		}
		else {
			SEARCH_HANDLER.disabled = true;
			SEARCH_HANDLER_LABEL.disabled = true;
			PREVIEW_HANDLER.disabled = true;
			PREVIEW_HANDLER_LABEL.disabled = true;
			THUMBNAIL_PROVIDER_HANDLER.disabled = true;
			THUMBNAIL_PROVIDER_HANDLER_LABEL.disabled = true;
			HANDLER_GEN_ATL_DOC.disabled = true;
			HANDLER_GEN_ATL_DOC_LABEL.disabled = true;
			HANDLER_FILE_EXTENSION.disabled = true;
			HANDLER_FILE_EXTENSION_LABEL.disabled = true;

			HANDLER_ATL_DOC_CLASS_NAME.disabled = true;
			HANDLER_ATL_DOC_CLASS_NAME_LABEL.disabled = true;
			HANDLER_GEN_ATL_DOC.disabled = true;
			HANDLER_GEN_ATL_DOC_LABEL.disabled = true;
			HANDLER_ATL_DOC_HEADER_FILE.disabled = true;
			HANDLER_ATL_DOC_HEADER_FILE_LABEL.disabled = true;
			BrowseATLDocumentHeader.disabled = true;
			HANDLER_ATL_DOC_IMPL_FILE.disabled = true;
			HANDLER_ATL_DOC_IMPL_FILE_LABEL.disabled = true;

			HANDLER_DOCUMENT_NAME.disabled = true;
			HANDLER_DOCUMENT_NAME_LABEL.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderDoc.disabled = true;
			HANDLER_VIEW_NAME.disabled = true;
			HANDLER_VIEW_NAME_LABEL.disabled = true;
			HANDLER_VIEW_FILE_NAME.disabled = true;
			HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderView.disabled = true;
		}
	}

	function SetAndValidate() {
		if (ADD_HANDLER_SUPPORT.checked) {
			var strExtension = TrimStr(HANDLER_FILE_EXTENSION.value);
			HANDLER_FILE_EXTENSION.value = strExtension;
			if (strExtension == "" || !ValidateExtension(strExtension)) {
				var L_Err_Text = "您必须指定一个有效的文档文件扩展名。扩展名不能包含空格或以下任何字符: <>.\"\\/|:?*。";
				window.external.ReportError(L_Err_Text);
				HANDLER_FILE_EXTENSION.focus();
				return false;
			}

			// If handler support is checked, then either an MFC document class or an ATL document
			// class must be specified. If neither is specified then pop an error message.
			if (HANDLER_ATL_DOC_CLASS_NAME.value == "" && HANDLER_DOCUMENT_NAME.value == "") {
				var L_NoDocClass_Err_Text = "必须指定一个文档类。";
				window.external.ReportError(L_NoDocClass_Err_Text);
				HANDLER_ATL_DOC_CLASS_NAME.focus();
				return false;
			}

			// If preview handler support is checked and an MFC document class is specified, then
			// an MFC view clas must also be specified.  If not, then pop an error message.
			if (HANDLER_DOCUMENT_NAME.value != "" && HANDLER_VIEW_NAME.value == "" && PREVIEW_HANDLER.checked == true) {
				var L_NoViewClass_Err_Text = "必须指定一个视图类。";
				window.external.ReportError(L_NoViewClass_Err_Text);
				HANDLER_VIEW_NAME.focus();
				return false;
			}

			if (!ValidateATLDocInput()) {
				HANDLER_ATL_DOC_CLASS_NAME.focus();
				return false;
			}

			if (HANDLER_ATL_DOC_CLASS_NAME.value == "") {
				TrimAndAdd("HANDLER_DOCUMENT_NAME_SPECIFIED", "HANDLER_DOCUMENT_NAME_TRIMMED", HANDLER_DOCUMENT_NAME);
				TrimAndAddFileName("HANDLER_DOCUMENT_HEADER_SPECIFIED", "HANDLER_DOCUMENT_FILE_NAME_TRIMMED", HANDLER_DOCUMENT_FILE_NAME);
				if (PREVIEW_HANDLER.checked == true) {
					TrimAndAdd("HANDLER_VIEW_NAME_SPECIFIED", "HANDLER_VIEW_NAME_TRIMMED", HANDLER_VIEW_NAME);
					TrimAndAddFileName("HANDLER_VIEW_HEADER_SPECIFIED", "HANDLER_VIEW_FILE_NAME_TRIMMED", HANDLER_VIEW_FILE_NAME);
				}
			}
			else {
				TrimAndAdd("HANDLER_ATL_DOC_CLASS_NAME_SPECIFIED", "HANDLER_ATL_DOC_CLASS_NAME_TRIMMED", HANDLER_ATL_DOC_CLASS_NAME);
				TrimAndAdd("HANDLER_ATL_DOC_HEADER_FILE_SPECIFIED", "HANDLER_ATL_DOC_HEADER_FILE_TRIMMED", HANDLER_ATL_DOC_HEADER_FILE);
				if (HANDLER_GEN_ATL_DOC.checked) {
					TrimAndAdd("HANDLER_ATL_DOC_IMPL_FILE_SPECIFIED", "HANDLER_ATL_DOC_IMPL_FILE_TRIMMED", HANDLER_ATL_DOC_IMPL_FILE);
				}
			}
		}

		return true;
	}

	function ValidateExtension(strExt) {
		if (strExt.indexOf("<") >= 0 || strExt.indexOf(">") >= 0 || strExt.indexOf("\"") >= 0 || strExt.indexOf(" ") >= 0 ||
			strExt.indexOf("/") >= 0 || strExt.indexOf("\\") >= 0 || strExt.indexOf("|") >= 0 || strExt.indexOf(":") >= 0 ||
			strExt.indexOf("?") >= 0 || strExt.indexOf("*") >= 0 || strExt.indexOf(".") >= 0) {
			return false;
		}
		return true;
	}

	function ValidateATLDocInput() {
		var oInvalid = null;

		if (HANDLER_GEN_ATL_DOC.checked && HANDLER_ATL_DOC_CLASS_NAME.value == window.external.FindSymbol("CLASS_NAME")) {
			L_ERROR4_Text = "文档名称不能与处理程序的类名称相同。";
			oErrObj = new Error(L_ERROR4_Text);
			SetErrorInfo(oErrObj);
			oInvalid = HANDLER_ATL_DOC_CLASS_NAME;
		}
		else if (HANDLER_GEN_ATL_DOC.checked && HANDLER_ATL_DOC_CLASS_NAME.value == window.external.FindSymbol("COCLASS")) {
			L_ERROR4_Text = "文档名称不能与处理程序的组件类名称相同。";
			oErrObj = new Error(L_ERROR4_Text);
			SetErrorInfo(oErrObj);
			oInvalid = HANDLER_ATL_DOC_CLASS_NAME;
		}
		else if (HANDLER_GEN_ATL_DOC.checked == false)
			return true;


		if (oInvalid == null) {
			if (!HANDLER_ATL_DOC_CLASS_NAME.value.length) {
				L_ERROR3_Text = "必须输入类名。";
				oErrObj = new Error(L_ERROR3_Text);
				SetErrorInfo(oErrObj);
				oInvalid = HANDLER_ATL_DOC_CLASS_NAME;
			}
			else {
				if (!Validate(HANDLER_ATL_DOC_CLASS_NAME))
					oInvalid = HANDLER_ATL_DOC_CLASS_NAME;
			}
		}

		if (oInvalid == null)
			if (!Validate(HANDLER_ATL_DOC_HEADER_FILE))
			oInvalid = HANDLER_ATL_DOC_HEADER_FILE;

		if (oInvalid == null)
			if (!Validate(HANDLER_ATL_DOC_IMPL_FILE))
			oInvalid = HANDLER_ATL_DOC_IMPL_FILE;

		if (oInvalid != null) {
			if (gbShowError)
				window.external.ReportError();
			else
				gbShowError = true;
			oInvalid.focus();
			return false;
		}
		return true;
	}

	var gbShowError = true;

	function Validate(obj) {
		var bValid = true;
		switch (obj.id) {
			case "HANDLER_ATL_DOC_CLASS_NAME":
				bValid = window.external.ParentObject.ValidateMember(obj.value, vsCMElementClass) &&
					window.external.dte.VCLanguageManager.ValidateIdentifier(obj.value) &&
					!window.external.dte.VCLanguageManager.IsReservedName(obj.value);
				break;
			case "HANDLER_ATL_DOC_HEADER_FILE":
				gbShowError = bValid = CanUseFileName(obj.value, true);
				if (!bValid)
					break;
				bValid = ValidateFileNameAndEnsureInProject(obj.value);
				break;
			case "HANDLER_ATL_DOC_IMPL_FILE":
				gbShowError = bValid = CanUseFileName(obj.value);
				if (!bValid)
					break;
				bValid = ValidateFileNameAndEnsureInProject(obj.value, vsCMValidateFileExtCppSource);
				break;
			default:
				break;
		}

		if (typeof (bValid) == "undefined")
			bValid = false;

		return bValid;
	}

	function TrimAndAddFileName(symbolbool, symboltrim, obj) {
		var strFileName = TrimStr(obj.value);
		var strNewFileName;

		if (strFileName != "") {
			if (window.external.FindSymbol("PROJECT_PATH")) {
				// try to build a relative path to the filename (so #includes will have relative paths)
				var strProjectPath = window.external.FindSymbol("PROJECT_PATH");

				// strip off the lowest level directory and compare.
				var nLength = strProjectPath.length;
				var nEndIndex = nLength - 1;
				if (strProjectPath.charAt(nEndIndex) == '\\') {
					nEndIndex = nEndIndex - 1;
				}
				while (nEndIndex > 0 && (strProjectPath.charAt(nEndIndex) != '\\')) {
					nEndIndex--;
				}

				var strCommonPath = strProjectPath.substring(0, nEndIndex + 1);
				var strCommonPathLower = strCommonPath.toLowerCase();
				var strFileNameSub = strFileName.substring(0, strCommonPath.length);
				var strFileNameSubLower = strFileNameSub.toLowerCase();
				if (strCommonPathLower == strFileNameSubLower) {
					strNewFileName = "..\\" + strFileName.substring(strCommonPath.length, strFileName.length);
				}
				else {
					// strip off the next lowest level directory and compare.
					if (strProjectPath.charAt(nEndIndex) == '\\') {
						nEndIndex = nEndIndex - 1;
					}
					while (nEndIndex > 0 && (strProjectPath.charAt(nEndIndex) != '\\')) {
						nEndIndex--;
					}

					var strCommonPath = strProjectPath.substring(0, nEndIndex + 1);
					var strCommonPathLower = strCommonPath.toLowerCase();
					var strFileNameSub = strFileName.substring(0, strCommonPath.length);
					var strFileNameSubLower = strFileNameSub.toLowerCase();
					if (strCommonPathLower == strFileNameSubLower) {
						strNewFileName = "..\\..\\" + strFileName.substring(strCommonPath.length, strFileName.length);
					}
				}
			}
		}

		if (strNewFileName != "") {
			window.external.AddSymbol(symbolbool, true);
			window.external.AddSymbol(symboltrim, strNewFileName);
		}
		else if (strFileName != "") {
			window.external.AddSymbol(symbolbool, true);
			window.external.AddSymbol(symboltrim, strFileName);
		}
		else {
			window.external.AddSymbol(symbolbool, false);
		}
	}

	function TrimAndAdd(symbolbool, symboltrim, obj) {
		var str = TrimStr(obj.value);

		if (str == "") {
			window.external.AddSymbol(symbolbool, false);
		}
		else {
			window.external.AddSymbol(symboltrim, str);
			window.external.AddSymbol(symbolbool, true);
		}
	}

	function OnMFCDocClassName() {
		var strClassName = TrimStr(HANDLER_DOCUMENT_NAME.value);
		var strLen = strClassName.length;

		HANDLER_ATL_DOC_CLASS_NAME.disabled = strLen > 0;
		HANDLER_ATL_DOC_CLASS_NAME_LABEL.disabled = strLen > 0;
		HANDLER_GEN_ATL_DOC.disabled = strLen > 0;
		HANDLER_GEN_ATL_DOC_LABEL.disabled = strLen > 0;

		HANDLER_DOCUMENT_FILE_NAME.disabled = strLen == 0;
		HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = strLen == 0;
		BrowseBtnHeaderDoc.disabled = strLen == 0;
	}

	function OnMFCViewClassName() {
		var strClassName = TrimStr(HANDLER_VIEW_NAME.value);
		var strLen = strClassName.length;

		HANDLER_VIEW_FILE_NAME.disabled = strLen == 0;
		HANDLER_VIEW_FILE_NAME_LABEL.disabled = strLen == 0;
		BrowseBtnHeaderView.disabled = strLen == 0 || HANDLER_GEN_ATL_DOC.checked;
	}

	function OnATLDocClassName() {
		var strClassName = TrimStr(HANDLER_ATL_DOC_CLASS_NAME.value);
		var strLen = strClassName.length;

		HANDLER_ATL_DOC_HEADER_FILE.disabled = strLen == 0;
		HANDLER_ATL_DOC_HEADER_FILE_LABEL.disabled = strLen == 0;
		BrowseATLDocumentHeader.disabled = strLen == 0 || HANDLER_GEN_ATL_DOC.checked;

		if (strLen > 0) {
			HANDLER_DOCUMENT_NAME.disabled = true;
			HANDLER_DOCUMENT_NAME_LABEL.disabled = true;
			HANDLER_VIEW_NAME.disabled = true;
			HANDLER_VIEW_NAME_LABEL.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderDoc.disabled = true;
			HANDLER_VIEW_FILE_NAME.disabled = true;
			HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderView.disabled = true;
		}
		else if (!HANDLER_GEN_ATL_DOC.checked && isMFCProject) {
			HANDLER_DOCUMENT_NAME.disabled = false;
			HANDLER_DOCUMENT_NAME_LABEL.disabled = false;
			if (PREVIEW_HANDLER.checked == true) {
				HANDLER_VIEW_NAME.disabled = false;
				HANDLER_VIEW_NAME_LABEL.disabled = false;
			}
		}

		if (strLen) {
			if ((strClassName.substr(0, 1) == "C") && ((strLen == 1) || !(strClassName.charAt(1).toLowerCase() == strClassName.charAt(1)))) {
				if (strLen == 1) {
					HANDLER_ATL_DOC_HEADER_FILE.value = "";
					HANDLER_ATL_DOC_IMPL_FILE.value = "";
				}
				else {
					HANDLER_ATL_DOC_HEADER_FILE.value = strClassName.substr(1, strLen) + ".h";
					if (HANDLER_GEN_ATL_DOC.checked) {
						HANDLER_ATL_DOC_IMPL_FILE.value = strClassName.substr(1, strLen) + ".cpp";
					}
					else {
						HANDLER_ATL_DOC_IMPL_FILE.value = "";
					}
				}
			}
			else {
				HANDLER_ATL_DOC_HEADER_FILE.value = strClassName + ".h";
				if (HANDLER_GEN_ATL_DOC.checked) {
					HANDLER_ATL_DOC_IMPL_FILE.value = strClassName + ".cpp";
				}
				else {
					HANDLER_ATL_DOC_IMPL_FILE.value = "";
				}
			}
		}
		else {
			HANDLER_ATL_DOC_HEADER_FILE.value = "";
			HANDLER_ATL_DOC_IMPL_FILE.value = "";
		}
	}

	function OnGenATLDocChange() {
		var genAtlDocChecked = HANDLER_GEN_ATL_DOC.checked;

		if (genAtlDocChecked) {
			HANDLER_ATL_DOC_CLASS_NAME.disabled = false;
			HANDLER_ATL_DOC_CLASS_NAME_LABEL.disabled = false;
			HANDLER_DOCUMENT_NAME.value = "";
		}

		BrowseATLDocumentHeader.disabled = genAtlDocChecked;
		HANDLER_ATL_DOC_IMPL_FILE.disabled = !genAtlDocChecked;
		HANDLER_ATL_DOC_IMPL_FILE_LABEL.disabled = !genAtlDocChecked;

		if (genAtlDocChecked == true) {
			HANDLER_DOCUMENT_NAME.disabled = true;
			HANDLER_DOCUMENT_NAME_LABEL.disabled = true;
			HANDLER_VIEW_NAME.disabled = true;
			HANDLER_VIEW_NAME_LABEL.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderDoc.disabled = true;
			HANDLER_VIEW_FILE_NAME.disabled = true;
			HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderView.disabled = true;
			OnATLDocClassName();
		}
		else {
			HANDLER_ATL_DOC_IMPL_FILE.value = "";
			OnHandlerChange();
		}
	}

	function OnHandlerChange() {
		if (ADD_HANDLER_SUPPORT.checked) {
			if (isMFCProject) {
				if (PREVIEW_HANDLER.checked == true && HANDLER_GEN_ATL_DOC.checked == false && HANDLER_ATL_DOC_CLASS_NAME.value == "") {
					HANDLER_VIEW_NAME.disabled = false;
					HANDLER_VIEW_NAME_LABEL.disabled = false;
				}
				else {
					HANDLER_VIEW_NAME.disabled = true;
					HANDLER_VIEW_NAME_LABEL.disabled = true;
					HANDLER_VIEW_FILE_NAME.disabled = true;
					HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
					BrowseBtnHeaderView.disabled = true;
				}

				if (SEARCH_HANDLER.checked) {
					window.external.AddSymbol("THREADING_APARTMENT", false);
					window.external.AddSymbol("THREADING_BOTH", true);
				}
				else {
					window.external.AddSymbol("THREADING_APARTMENT", true);
					window.external.AddSymbol("THREADING_BOTH", false);
				}

				var strClassName = TrimStr(HANDLER_ATL_DOC_CLASS_NAME.value);
				var disableMFCDoc = strClassName.length > 0 || HANDLER_GEN_ATL_DOC.checked;

				HANDLER_DOCUMENT_NAME.disabled = disableMFCDoc;
				HANDLER_DOCUMENT_NAME_LABEL.disabled = disableMFCDoc;
			}
			else {
				HANDLER_VIEW_NAME.disabled = true;
				HANDLER_VIEW_NAME_LABEL.disabled = true;
				HANDLER_DOCUMENT_NAME.disabled = true;
				HANDLER_DOCUMENT_NAME_LABEL.disabled = true;
				HANDLER_DOCUMENT_FILE_NAME.disabled = true;
				HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = true;
				BrowseBtnHeaderDoc.disabled = true;
				HANDLER_VIEW_FILE_NAME.disabled = true;
				HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
				BrowseBtnHeaderView.disabled = true;
			}
		}
		else {
			HANDLER_ATL_DOC_CLASS_NAME.disabled = true;
			HANDLER_ATL_DOC_CLASS_NAME_LABEL.disabled = true;
			HANDLER_GEN_ATL_DOC.disabled = true;
			HANDLER_GEN_ATL_DOC_LABEL.disabled = true;
			HANDLER_ATL_DOC_HEADER_FILE.disabled = true;
			HANDLER_ATL_DOC_HEADER_FILE_LABEL.disabled = true;
			BrowseATLDocumentHeader.disabled = true;
			HANDLER_ATL_DOC_IMPL_FILE.disabled = true;
			HANDLER_ATL_DOC_IMPL_FILE_LABEL.disabled = true;

			HANDLER_DOCUMENT_NAME.disabled = true;
			HANDLER_DOCUMENT_NAME_LABEL.disabled = true;
			HANDLER_VIEW_NAME.disabled = true;
			HANDLER_VIEW_NAME_LABEL.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME.disabled = true;
			HANDLER_DOCUMENT_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderDoc.disabled = true;
			HANDLER_VIEW_FILE_NAME.disabled = true;
			HANDLER_VIEW_FILE_NAME_LABEL.disabled = true;
			BrowseBtnHeaderView.disabled = true;
		}
	}

	function OnBrowseHeaderFile(obj) {
		var strFile;
		try {
			var L_Prompt1_Text = "选择头文件";
			var L_Prompt2_Text = "Visual C++ 头文件(*.h)\0*.h\0\0";
			strFile = window.external.GetExistingFileNameViaDlg(L_Prompt1_Text, window.external.FindSymbol("PROJECT_PATH"), L_Prompt2_Text, obj.value);
		}
		catch (e) {
			if (e.number != OLE_E_PROMPTSAVECANCELLED) {
				var L_ErrMsg2_Text = "OnBrowseHeaderFile() 中有错误";
				if (e.description.length != 0) {
					L_ErrMsg2_Text += ": ";
					L_ErrMsg2_Text += e.description;
				}
				window.external.ReportError(L_ErrMsg2_Text);
			}
			return;
		}
		obj.value = strFile;
	}

	function OnBrowseImplementationFile(obj) {
		var strFile;
		try {
			var L_Prompt3_Text = "选择实现文件";
			var L_Prompt4_Text = "Visual C++ 源文件(*.cpp)\0*.cpp\0\0";
			strFile = window.external.GetExistingFileNameViaDlg(L_Prompt3_Text, window.external.FindSymbol("PROJECT_PATH"), L_Prompt4_Text, obj.value);
		}
		catch (e) {
			if (e.number != OLE_E_PROMPTSAVECANCELLED) {
				var L_ErrMsg3_Text = "OnBrowseImplementationFile() 中有错误";
				if (e.description.length != 0) {
					L_ErrMsg3_Text += ": ";
					L_ErrMsg3_Text += e.description;
				}
				window.external.ReportError(L_ErrMsg3_Text);
			}
			return;
		}
		obj.value = strFile;
	}

</script>

<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>

<script id="INCLUDE_COMMON" language="JSCRIPT"></script>

<script>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</script>

