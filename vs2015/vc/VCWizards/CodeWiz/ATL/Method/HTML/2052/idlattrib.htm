<!-- Copyright (c) Microsoft Corporation. All rights reserved. -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>添加方法向导</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
	<META HTTP-EQUIV="MSThemeCompatible" CONTENT="Yes">
	<LINK ID="LINKURL" REL="stylesheet" HREF="../../../../../2052/NewStyles.css">
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">

<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL WIDTH="178">
	<!--OPEN OF ALL ENCOMPASSING TABLE ROW ONE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN=2>
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer0">
		 <IMG CLASS="SMALLEST" SRC="..\..\Images\Method.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
		</DIV>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">IDL 特性</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">为此方法指定任何接口定义语言设置。</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
	</TR>
	 
	<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
 
    <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
	<TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="100%">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP">
	   <!--OPEN OF NAVIGATION TABLE//-->
	
	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->
	  		
			<DIV CLASS="LINK">
			 <TABLE WIDTH="100%" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="100%">
				<SPAN CLASS="ACTIVELINK" ID="Default" TITLE="指定方法名称和参数。" onClick="Next(document, 'default.htm');" TABINDEX="1">名称</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../../../../1033/Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>

		  	<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="100%">
				<SPAN ID="IDLAttrib" TITLE="为此方法指定任何 IDL 特性。">IDL 特性</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../../../../1033/Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>


	<TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
			 
 			 <TR VALIGN="TOP">
 			 <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
				<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" STYLE="TABLE-LAYOUT:FIXED;">
				 <TR VALIGN="TOP">
				  <TD VALIGN="TOP" WIDTH="50%">
				  	<SPAN CLASS="itemTextTop" ID="DISPID_SPAN" TITLE="用于标识此方法的数值 ID。">
					 <LABEL FOR="DISPID" ID="DISPID_LABEL">ID(<U>D</U>): </LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="DISPID" ACCESSKEY="D">
					 <BR>
					</SPAN>
				  	<SPAN CLASS="itemText" ID="CALL_AS_SPAN" TITLE="使您能够将无法以远程方式调用的函数映射到远程函数。" STYLE="POSITION:RELATIVE; TOP:12PX;">
					 <LABEL FOR="CALL_AS" ID="CALL_AS_LABEL">call_as(<u>A</u>): </LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="CALL_AS" ACCESSKEY="A">
					</SPAN>
				  </TD>
				  <TD VALIGN="TOP" WIDTH="50%">
				  	<SPAN CLASS="itemTextTop" TYPE="TEXT" ID="HELP_CONTEXT_SPAN" TITLE="指定一个上下文 ID，使用户在帮助文件中查看关于此元素的信息。">
					 <LABEL FOR="HELP_CONTEXT" ID="HELP_CONTEXT_LABEL">helpcontext(<u>X</u>): </LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="HELP_CONTEXT" ACCESSKEY="X">
					 <BR>
					</SPAN>
				  	<SPAN CLASS="itemText" ID="HELP_STRING_SPAN" TITLE="此方法的字符串说明。" STYLE="POSITION:RELATIVE; TOP:12PX;">
					 <LABEL FOR="HELP_STRING" ID="HELP_STRING_LABEL">helpstring(<U>G</U>): </LABEL>
					 <BR>
					 <INPUT CLASS="sideBtn" TYPE="TEXT" ID="HELP_STRING" ACCESSKEY="G">
					</SPAN>
				  </TD>
				  </TR>
				
				<TR VALIGN="TOP">
				 <TD COLSPAN="2" HEIGHT="30">
				  &nbsp;
				 </TD>
				</TR>

				  <TR VALIGN="TOP">
				   <TD VALIGN="TOP" WIDTH="100">
					 <SPAN ID="HIDDEN_SPAN" TITLE="指示该项存在，但不应在面向用户的浏览器中显示。">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="HIDDEN" ACCESSKEY="E">
	  	 			  <DIV CLASS="itemTextCheckboxA">
		  			  <LABEL FOR="HIDDEN" ID="HIDDEN_LABEL">hidden(<u>E</u>)</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="SOURCE_SPAN" TITLE="指示此方法是事件源。">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="SOURCE" ACCESSKEY="S">
	  	 			  <DIV CLASS="itemTextCheckboxA">
	  	 			  <LABEL FOR="SOURCE" ID="SOURCE_LABEL">source(<u>S</u>)</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="LOCAL_SPAN" TITLE="向 MIDL 编译器指定某个接口或函数不是远程的。">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="LOCAL" ACCESSKEY="L">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL FOR="LOCAL" ID="LOCAL_LABEL">local(<u>L</u>)</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="RESTRICTED_SPAN" TITLE="指示不能任意调用此方法。">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="RESTRICTED" ACCESSKEY="R">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL FOR="RESTRICTED" ID="RESTRICTED_LABEL">restricted(<u>R</u>)</LABEL>
					  </DIV>
					  </SPAN>
					 
					<BR>
					
					 <SPAN ID="VAR_ARG_SPAN" TITLE="指定该函数采用的参数数目可变。为了满足这个条件，最后一个参数必须是包含所有剩余参数的 VARIANT 类型的安全数组。">
					  <INPUT TYPE="checkbox" CLASS="CheckBox" ID="VAR_ARG" ACCESSKEY="V">
	  	 			  <DIV CLASS="itemTextCheckboxA">
 	  	 			  <LABEL id="VAR_ARG_LABEL" FOR="VAR_ARG">vararg(<u>V</u>)</LABEL>
					  </DIV>
					  </SPAN>
					 </NOBR>
					</SPAN>
				  </TD>
				 </TR>
				</TABLE>
			  </TD>
  		  	  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  		  	  </TD>
 		  	 </TR>
		 	</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD>
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">完成</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">取消</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.codewiz.method.idlattrib');">帮助</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
	   <!--CLOSE OF CONTENT AND BUTTON TABLE//-->
	   </TD>
	  </TR>
	 </TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = IDLAttrib;

var gbRetVal = false;

function InitDocument(document)
{
	setDirection();

	window.external.Load(document);

	var bVarArgDisabled = window.external.FindSymbol("VAR_ARG_DISABLED")
	if (bVarArgDisabled)
	{
		VAR_ARG.disabled = true;
		VAR_ARG_LABEL.disabled = true;
	}
	
	var bDispIdDisabled = window.external.FindSymbol("DISPID_DISABLED");
	if (bDispIdDisabled)
	{
		DISPID.disabled = true;
		DISPID_LABEL.disabled = true;
	}
}

function Next(document, linkto)
{
	if (!ValidateInput())
		return;
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	if (window.external.FindSymbol("EXTERNAL_NAME").length == 0)
	{
		var L_ErrMsg1_Text = "需要指定方法名。";
		window.external.ReportError(L_ErrMsg1_Text);
		window.external.Next(document, "default.htm");
		return;
	}

	if (!ValidateInput())
		return;

	OnWizFinish(document);
}


function ValidateInput()
{
	try
	{
		if (!DISPID.disabled)
		{
			if (DISPID.value.length == 0)
			{
				var L_ErrMsg3_Text = "必须指定 DISPID。";
				window.external.ReportError(L_ErrMsg3_Text);
				DISPID.focus();
				return false;
			}

			// convert to numeric
			var x = DISPID.value - 0;
			// if conversion failed
			if (isNaN(x))
			{
				var L_ErrMsg8_Text = "DISPID 必须为数值。";
				window.external.ReportError(L_ErrMsg8_Text);
				DISPID.focus();
				return false;
			}
		}

		if (CALL_AS.value.length)
		{
			var oInterface = window.external.ParentObject;
			var oFunction = oInterface.Functions.Find(CALL_AS.value);

			if (!oFunction)
			{
				var L_ErrMsg4_Text = "call_as 函数必须存在。";
				window.external.ReportError(L_ErrMsg4_Text);
				CALL_AS.focus();
				return false;
			}
			else
			{
				if (!oFunction.Attributes.Find("local"))
				{
					var L_ErrMsg5_Text = "call_as 函数必须具有 [local] 特性。";
					window.external.ReportError(L_ErrMsg5_Text);
					CALL_AS.focus();
					return false;
				}
				else if (oFunction.Attributes.Find("propput") || oFunction.Attributes.Find("propget") || oFunction.Attributes.Find("propputref"))
				{
					var L_ErrMsg9_Text = "call_as 函数不能是 [propput]、[propget] 或 [propputref]。";
					window.external.ReportError(L_ErrMsg9_Text);
					CALL_AS.focus();
					return false;
				}
			}
		}

		if (HELP_CONTEXT.value.length)
		{
			// convert to numeric
			var x = HELP_CONTEXT.value - 0;
			// if conversion failed
			if (isNaN(x))
			{
				var L_ErrMsg6_Text = "helpcontext 必须为数值。";
				window.external.ReportError(L_ErrMsg6_Text);
				HELP_CONTEXT.focus();
				return false;
			}
		}
		return true;
	}
	catch(e)
	{
		var L_ErrMsg7_Text = "ValidateInput() 中有错误";
		if (e.description.length != 0)
		{
			L_ErrMsg7_Text += ": ";
			L_ErrMsg7_Text += e.description;
		}
		window.external.ReportError(L_ErrMsg7_Text);
		return false;
	}
}
</SCRIPT>

<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</SCRIPT>
