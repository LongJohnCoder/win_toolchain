<!-- Copyright (c) Microsoft Corporation. All rights reserved. -->
<html dir="LTR">
<head>
	<title>ATL 项目向导</title>
	<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	<meta http-equiv="MSThemeCompatible" content="Yes">
	<link id="LINKURL" rel="stylesheet" href="../../../../../2052/NewStyles.css">
</head>
<body bgcolor="BUTTONFACE" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"
	onload="InitDocument(document);" onkeydown="OnKey();" onkeypress="OnPress();">
	<table class="ONE" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
		<col width="178">
		<col>
		<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
		<tr valign="TOP">
			<td height="79" width="100%" colspan="2">
				<table class="TWO" border="0" cellpadding="0" cellspacing="0">
					<col width="12">
					<col>
					<col width="12">
					<tr>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td class="IMAGE" valign="BOTTOM" width="110" rowspan="2">
							<div class="SMALLA" id="DLL_APP_IMAGE">
								<img class="SMALL" class="SMALL" src="../../Images/DLLApplication.gif" width="98"
									height="70" alt="">
							</div>
							<div class="SMALL" id="EXE_APP_IMAGE">
								<img class="SMALL" src="..\..\Images\Executable.gif" width="98" height="70" alt="">
							</div>
							<div class="SMALL" id="SERVICE_APP_IMAGE">
								<img class="SMALL" src="..\..\Images\ServiceApplication.gif" width="98" height="70"
									alt="">
							</div>
						</td>
						<td valign="TOP" height="12" width="6" rowspan="2">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="65">
							<h4 class="HEAD" id="HEAD">应用程序设置</h4>
							<p class="SUBHEAD" id="SUBHEAD">
								指定项目的应用程序类型和功能支持。</p>
						</td>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" class="RULE" colspan="5" height="2">
							<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
								<tr valign="TOP">
									<td height="1" width="100%" bgcolor="BUTTONSHADOW">
									</td>
									<td height="1" width="1" bgcolor="WINDOW">
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
		<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
		<tr valign="TOP">
			<td class="Three" valign="TOP" height="100%" width="100%">
				<table class="fixedSize" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
					<tr valign="TOP">
						<td class="threeCustom" valign="TOP">
							<!--OPEN OF NAVIGATION TABLE//-->
							<table class="THREE" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col width="166">
								<col width="1">
								<tr>
									<td valign="TOP" colspan="3" height="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="100%">
										&nbsp;
									</td>
									<td valign="TOP" height="100%">
										<!--OPEN OF NAVIGATIONAL LINKS//-->
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="162">
														<span id="Default" class="ACTIVELINK" title="查看所选内容的概述。"
															onclick="Next(document, 'Default.htm');" tabindex="1">概述</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINKSELECTED">
											<span class="VERTLINE1">
												<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
											</span><span class="HORILINE1">
												<table width="167" height="100%" border="0" cellpadding="0" cellspacing="0">
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
													<tr valign="TOP">
														<td height="100%">
															<img src="../../../../../1033/Images/spacer.gif" width="1" height="28" alt="" border="0">
														</td>
													</tr>
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
												</table>
											</span>
											<table width="160" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXTSELECTED">
												<tr valign="MIDDLE">
													<td width="100%">
														<span id="AppSettings" title="指定 ATL 项目的应用程序类型和功能支持。">
															应用程序设置</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<!--CLOSE OF NAVIGATIONAL LINKS//-->
									</td>
									<td width="1">
										<div class="VERTLINE">
											<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
										</div>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION TABLE//-->
			</td>
			<td valign="TOP" height="100%">
				<!--OPEN OF CONTENT AND BUTTON TABLE//-->
				<table class="ONE" border="0" cellpadding="0" cellspacing="0">
					<col width="100%">
					<tr valign="TOP">
						<td height="100%">
							<!--OPEN OF CONTENT//-->
							<table class="CONTENT" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col width="398">
								<col width="12">
								<tr>
									<td valign="TOP">
										<table class="FixedSize" border="0" cellpadding="0" cellspacing="0">
											<col width="12">
											<col width="193">
											<col width="12">
											<col width="230">
											<col width="12">
											<tr>
												<td valign="TOP" height="12" colspan="3">
													&nbsp;
												</td>
											</tr>
											<tr>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="SERVERTYPE_SPAN"><b>应用程序类型:</b>
														<p class="Spacer">
															&nbsp;</p>
														<input type="radio" class="Radio" name="servertype" id="DLL_APP" accesskey="D" title="指定项目为动态链接库。"
															onpropertychange="InitControls();">
														<div class="itemTextRadioB" id="DLL_DIV" title="指定项目为动态链接库。">
															<label for="DLL_APP" id="DLL_APP_LABEL">动态链接库(DLL)(<u>D</u>)</label>
														</div>
														<br>
														<input type="radio" class="Radio" name="servertype" id="EXE_APP" accesskey="E" title="指定项目为可执行应用程序。"
															onpropertychange="InitControls();">
														<div class="itemTextRadioB" id="EXE_DIV" title="指定项目为可执行应用程序。">
															<label for="EXE_APP" id="EXE_APP_LABEL">可执行文件(EXE)(<u>E</u>)</label>
														</div>
														<br>
														<input type="radio" class="Radio" name="servertype" id="SERVICE_APP" accesskey="S"
															title="指定该服务器也是当 NT 启动时在后台运行的 Windows NT 服务。"
															onpropertychange="InitControls();">
														<div class="itemTextRadioB" id="SERVICE_DIV" title="指定该服务器也是当 NT 启动时在后台运行的 Windows NT 服务。">
															<label for="SERVICE_APP" id="SERVICE_APP_LABEL">服务(EXE)(<u>S</u>)</label>
														</div>
													</span>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="toolbars_title"><b>支持选项:</b>
														<p class="Spacer">
															&nbsp;</p>
														<input type="Checkbox" class="CheckboxA" id="MERGE_PROXY_STUB" accesskey="P" title="指定代理/存根(stub)代码合并到您的主项目中。默认情况下，代理/存根(stub)封送处理代码包含在一个单独的 DLL 中。">
														<div class="itemTextCheckboxB" id="PROXY_DIV" title="指定代理/存根(stub)代码合并到您的主项目中。默认情况下，代理/存根(stub)封送处理代码包含在一个单独的 DLL 中。">
															<label for="MERGE_PROXY_STUB" id="MERGE_PROXY_STUB_LABEL">允许合并代理/存根代码(<u>P</u>)</label>
														</div>
														<br>
														<input type="Checkbox" class="CheckboxA" id="SUPPORT_MFC" accesskey="M" onpropertychange="OnExtensionChange();"
															title="增加访问 MFC 库的能力。">
														<div class="itemTextCheckboxB" id="MFC_DIV" title="增加访问 MFC 库的能力。">
															<label for="SUPPORT_MFC" id="SUPPORT_MFC_LABEL">支持 MFC(<u>M</u>)</label>
														</div>
														<br>
														<input type="Checkbox" class="CheckboxA" id="SUPPORT_COMPLUS" accesskey="T" title="增加支持 COM+ 1.0 的能力。"
															onpropertychange="OnComPlusChange();">
														<div class="itemTextCheckboxB" id="COMPLUS_LABEL" title="增加支持 COM+ 1.0 的能力。">
															<label for="SUPPORT_COMPLUS" id="SUPPORT_COMPLUS_LABEL">支持 COM+ 1.0(<u>T</u>)</label>
														</div>
														<br>
														<input class="CheckboxIndent" type="checkbox" id="SUPPORT_COMPONENT_REGISTRAR" accesskey="U"
															title="添加对部件注册器的支持。" disabled>
														<div class="itemTextCheckboxIndentB" id="COMPONENT_REGISTRAR_DIV" title="添加对部件注册器的支持。">
															<label for="SUPPORT_COMPONENT_REGISTRAR" id="SUPPORT_COMPONENT_REGISTRAR_LABEL">支持部件注册器(<u>U</u>)</label>
														</div>
														<br>
														<input type="Checkbox" class="CheckboxA" id="SDL_CHECK" accesskey="C"
															title="启用附加安全开发生命周期(SDL)检查。">
														<div class="itemTextCheckboxB" id="SDL_CHECK_DIV" title="启用附加安全开发生命周期(SDL)检查。">
															<label for="SDL_CHECK" id="SDL_CHECK_LABEL">安全开发生命周期(SDL)检查(<U>C</U>)</label>
														</div>
													</span>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP">
										<span class="itemText" id="FILETYPE_SPAN"><b>文件类型处理程序选项:</b> </span>
									</td>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP">
										<table class="FixedSize" border="0" cellpadding="0" cellspacing="0">
											<col width="20">
											<col width="190">
											<col width="12">
											<col width="192">
											<col width="8">
											<tr>
												<td valign="TOP" width="20">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="FILE_EXTENSION_TITLE" title="已向预览/缩略图/搜索处理程序注册的文件扩展名。">
														<label id="FILE_EXTENSION_LABEL" for="FILE_EXTENSION">文件扩展名(<u>X</u>): </label>
														<br>
														<input class="sideBtn" type="text" name="FileExt" id="FILE_EXTENSION" accesskey="x"
															onpropertychange="OnExtensionChange();" tabindex="8">
													</span>
													<p class="Spacer">
														&nbsp;</p>
													<span id="PREVIEW_HANDLER_TITLE" title="指定将向您的项目中添加预览处理程序。">
														<input type="Checkbox" class="Checkbox" id="PREVIEW_HANDLER" accesskey="V" onpropertychange="OnHandlerChange();"
															title="指定将向您的项目中添加预览处理程序。">
														<div class="itemTextCheckboxA" id="PREVIEW_LABEL">
															<label for="PREVIEW_HANDLER" id="PREVIEW_HANDLER_LABEL">预览处理程序(<u>V</u>)</label>
														</div>
													</span>
													<br>
													<span id="THUMBNAIL_HANDLER_TITLE" title="指定将向您的项目中添加缩略图处理程序。">
														<input type="Checkbox" class="Checkbox" id="THUMBNAIL_HANDLER" accesskey="B" onpropertychange="OnHandlerChange();"
															title="指定将向您的项目中添加缩略图处理程序。">
														<div class="itemTextCheckboxA" id="THUMBNAIL_LABEL">
															<label for="THUMBNAIL_HANDLER" id="THUMBNAIL_HANDLER_LABEL">缩略图处理程序(<u>B</u>)</label>
														</div>
													</span>
													<br>
													<span id="SEARCH_HANDLER_TITLE" title="指定将向您的项目中添加搜索处理程序。">
														<input type="Checkbox" class="Checkbox" id="SEARCH_HANDLER" accesskey="H" onpropertychange="OnHandlerChange();"
															title="指定将向您的项目中添加搜索处理程序。">
														<div class="itemTextCheckboxA" id="SEARCH_LABEL">
															<label for="SEARCH_HANDLER" id="SEARCH_HANDLER_LABEL">搜索处理程序(<u>H</u>)</label>
														</div>
													</span>
													<br>
													<p class="Spacer">
														&nbsp;</p>
													<p class="Spacer">
														&nbsp;</p>
													<span id="GENERATE_ATL_DOCUMENT_TITLE" title="生成基于 ATL 的文档。您可以为所有处理程序生成一个文档类。">
														<input type="Checkbox" class="Checkbox" id="GENERATE_ATL_DOCUMENT" accesskey="A" onpropertychange="OnGenATLDocChange();">
														<div class="itemTextCheckboxA" id="GENERATE_ATL_DOC_LABEL">
															<label for="GENERATE_ATL_DOCUMENT" id="GENERATE_ATL_DOCUMENT_LABEL">生成基于 ATL 的文档(<u>A</u>)</label>
														</div>
													</span>
												</td>
												<td valign="TOP" width="12">
													&nbsp;
												</td>
												<td valign="TOP">
													<span class="itemText" id="DOCUMENT_CLASS_TITLE" title="文档类名称。">
														<label id="DOCUMENT_CLASS_NAME_LABEL" for="DOCUMENT_CLASS_NAME">文档类名称(<u>O</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" name="DocClass" id="DOCUMENT_CLASS_NAME"
															accesskey="o" onpropertychange="OnDocClassNameChange();">
													</span>
													<p class="Spacer">
														&nbsp;</p>
													<span class="itemText" id="DOCUMENT_HEADER_TITLE" title="文档头文件名称。">
														<label id="DOCUMENT_HEADER_FILENAME_LABEL" for="DOCUMENT_HEADER_FILENAME">文档类头文件名称(<u>C</u>): </label>
														<br>
														<input class="sideBtn21" type="text" name="DocHeaderFile" id="DOCUMENT_HEADER_FILENAME"
															accesskey="c">
														<button class="buttonClass3Custom" id="BrowseDocumentHeader" accesskey="" type="BUTTON"
															title="浏览文档头文件" onclick="OnBrowseHeaderFile(DOCUMENT_HEADER_FILENAME);"
															tabindex="10">
															...</button>
													</span>
													<p class="Spacer">
														&nbsp;</p>
													<span class="itemText" id="DOCUMENT_IMPL_TITLE" title="文档实现文件名称。">
														<label id="DOCUMENT_IMPL_FILENAME_LABEL" for="DOCUMENT_IMPL_FILENAME">文档实现文件名称(<u>N</u>): </label>
														<br>
														<input class="sideBtnB" type="text" name="ImplFile" id="DOCUMENT_IMPL_FILENAME" accesskey="n">
													</span>
													<p class="Spacer">
														&nbsp;</p>
													<span class="itemText" id="VIEW_CLASS_TITLE" title="视图类名称。">
														<label id="VIEW_CLASS_NAME_LABEL" for="VIEW_CLASS_NAME">视图类名称(<u>W</u>): </label>
														<br>
														<input class="sideBtnB" maxlength="256" type="text" name="ViewClass" id="VIEW_CLASS_NAME"
															accesskey="w">
													</span>
													<p class="Spacer">
														&nbsp;</p>
													<span class="itemText" id="VIEW_HEADER_TITLE" title="视图头文件名称。">
														<label id="VIEW_HEADER_FILENAME_LABEL" for="VIEW_HEADER_FILENAME">视图类头文件名称(<u>F</u>): </label>
														<br>
														<input class="sideBtn21" type="text" name="ViewHeaderFile" id="VIEW_HEADER_FILENAME"
															accesskey="f">
														<button class="buttonClass3Custom" id="BrowseViewHeader" accesskey="" type="BUTTON"
															title="浏览文档头文件" onclick="OnBrowseHeaderFile(VIEW_HEADER_FILENAME);"
															tabindex="10">
															...</button>
													</span>
												</td>
												<td valign="TOP" width="8">
													&nbsp;
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</td>
						<td valign="TOP" width="12">
							&nbsp;
							<!--CLOSE OF CONTENT//-->
						</td>
					</tr>
					<tr valign="BOTTOM">
						<td>
							<!--OPEN OF BUTTON HTML//-->
							<table border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="12">
								<tr>
									<td valign="TOP" class="RULE" colspan="8" height="2">
										<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
											<tr valign="TOP">
												<td height="1" width="100%" bgcolor="BUTTONSHADOW">
												</td>
												<td height="1" width="1" bgcolor="WINDOW">
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="11" colspan="8">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
									<td valign="TOP" height="23">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="FinishBtn" onclick="OnFinish(document);">
											完成</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="CancelBtn" onclick="window.external.Finish(document, 'cancel');">
											取消</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="HelpBtn" onclick="window.external.OnHelp('vc.appwiz.atl.com.appset');">
											帮助</button>
									</td>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="12" colspan="8">
										&nbsp;
									</td>
								</tr>
							</table>
							<!--CLOSE OF BUTTON HTML//-->
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
			</td>
		</tr>
	</table>
</body>
</html>

<script language="JSCRIPT">

	var tab_array = new Array();
	tab_array[0] = Default;
	tab_array[1] = AppSettings;

	function InitDocument(document) {
		setDirection();
		window.external.Load(document);

		if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD")) {
			InitControls();
		}
		else {
			var strExt = window.external.FindSymbol("FILE_EXTENSION_SPECIFIED");
			FILE_EXTENSION.value = strExt;
		}

		DLL_APP.focus();
	}

	function Next(document, linkto) {
		if (!SetAndValidate())
			return;

		window.external.Next(document, linkto);
	}

	function OnFinish(document) {
		if (!SetAndValidate())
			return;

		OnWizFinish(document);
	}

	function InitControls() {
		MERGE_PROXY_STUB.checked = false;
		MERGE_PROXY_STUB.disabled = true;
		MERGE_PROXY_STUB_LABEL.disabled = true;
		SUPPORT_MFC.checked = false;
		SUPPORT_MFC.disabled = true;
		SUPPORT_MFC_LABEL.disabled = true;
		SUPPORT_COMPLUS.checked = false;
		SUPPORT_COMPLUS.disabled = true;
		SUPPORT_COMPLUS_LABEL.disabled = true;
		SUPPORT_COMPONENT_REGISTRAR.checked = false;
		SUPPORT_COMPONENT_REGISTRAR.disabled = true;
		SUPPORT_COMPONENT_REGISTRAR_LABEL.disabled = true;
		SDL_CHECK.disabled = false;
		SDL_CHECK_LABEL.disabled = false;
		FILE_EXTENSION.disabled = true;
		FILE_EXTENSION_LABEL.disabled = true;

		if (DLL_APP.checked) {
			MERGE_PROXY_STUB.disabled = false;
			MERGE_PROXY_STUB_LABEL.disabled = false;
			SUPPORT_MFC.disabled = false;
			SUPPORT_MFC_LABEL.disabled = false;
			SUPPORT_COMPLUS.disabled = false;
			SUPPORT_COMPLUS_LABEL.disabled = false;
			FILE_EXTENSION.disabled = false;
			FILE_EXTENSION_LABEL.disabled = false;
		} else if (EXE_APP.checked) {
			MERGE_PROXY_STUB.disabled = false;
			MERGE_PROXY_STUB_LABEL.disabled = false;
			FILE_EXTENSION.value = "";
		}
		else {
			FILE_EXTENSION.value = "";
		}
		if (SUPPORT_COMPLUS.checked && !SUPPORT_COMPLUS.disabled) {
			SUPPORT_COMPONENT_REGISTRAR.disabled = false;
			SUPPORT_COMPONENT_REGISTRAR_LABEL.disabled = false;
		}
		OnExtensionChange();
		ToggleImage();
	}

	function OnComPlusChange() {
		if (SUPPORT_COMPLUS.checked) {
			SUPPORT_COMPONENT_REGISTRAR.disabled = false;
			SUPPORT_COMPONENT_REGISTRAR_LABEL.disabled = false;
		}
		else {
			SUPPORT_COMPONENT_REGISTRAR.checked = false;
			SUPPORT_COMPONENT_REGISTRAR.disabled = true;
			SUPPORT_COMPONENT_REGISTRAR_LABEL.disabled = true;
		}
	}

	function OnExtensionChange() {
		var strExt = window.external.FindSymbol("FILE_EXTENSION_SPECIFIED");
		var strExtension = TrimStr(FILE_EXTENSION.value);
		window.external.AddSymbol("FILE_EXTENSION_SPECIFIED", strExtension);
		if (strExtension == "") {
			PREVIEW_HANDLER.checked = false;
			PREVIEW_HANDLER.disabled = true;
			PREVIEW_HANDLER_LABEL.disabled = true;
			THUMBNAIL_HANDLER.checked = false;
			THUMBNAIL_HANDLER.disabled = true;
			THUMBNAIL_HANDLER_LABEL.disabled = true;
			SEARCH_HANDLER.checked = false;
			SEARCH_HANDLER.disabled = true;
			SEARCH_HANDLER_LABEL.disabled = true;
			GENERATE_ATL_DOCUMENT.checked = false;
			GENERATE_ATL_DOCUMENT.disabled = true;
			GENERATE_ATL_DOCUMENT_LABEL.disabled = true;
		}
		else if (strExt == "") {
			PREVIEW_HANDLER.checked = true;
			PREVIEW_HANDLER.disabled = false;
			PREVIEW_HANDLER_LABEL.disabled = false;
			THUMBNAIL_HANDLER.checked = true;
			THUMBNAIL_HANDLER.disabled = false;
			THUMBNAIL_HANDLER_LABEL.disabled = false;
			SEARCH_HANDLER.checked = true;
			SEARCH_HANDLER.disabled = false;
			SEARCH_HANDLER_LABEL.disabled = false;
			if (SUPPORT_MFC.checked) {
				GENERATE_ATL_DOCUMENT.checked = false;
			}
			else {
				GENERATE_ATL_DOCUMENT.checked = true;
			}
			GENERATE_ATL_DOCUMENT.disabled = false;
			GENERATE_ATL_DOCUMENT_LABEL.disabled = false;
		}
		else {
			PREVIEW_HANDLER.disabled = false;
			PREVIEW_HANDLER_LABEL.disabled = false;
			THUMBNAIL_HANDLER.disabled = false;
			THUMBNAIL_HANDLER_LABEL.disabled = false;
			SEARCH_HANDLER.disabled = false;
			SEARCH_HANDLER_LABEL.disabled = false;
			if (SUPPORT_MFC.checked) {
				GENERATE_ATL_DOCUMENT.checked = false;
			}
			else {
				GENERATE_ATL_DOCUMENT.checked = true;
			}
			GENERATE_ATL_DOCUMENT.disabled = false;
			GENERATE_ATL_DOCUMENT_LABEL.disabled = false;
		}

		OnHandlerChange();
	}

	function OnHandlerChange() {
		if (THUMBNAIL_HANDLER.checked || SEARCH_HANDLER.checked || PREVIEW_HANDLER.checked) {
			GENERATE_ATL_DOCUMENT.disabled = false;
			GENERATE_ATL_DOCUMENT_LABEL.disabled = false;
			if (SUPPORT_MFC.checked) {
				GENERATE_ATL_DOCUMENT.checked = false;
			}
			else {
				GENERATE_ATL_DOCUMENT.checked = true;
			}
			DOCUMENT_CLASS_NAME.disabled = false;
			DOCUMENT_CLASS_NAME_LABEL.disabled = false;
			DOCUMENT_HEADER_FILENAME.disabled = false;
			DOCUMENT_HEADER_FILENAME_LABEL.disabled = false;
			BrowseDocumentHeader.disabled = false;
		}
		else {
			GENERATE_ATL_DOCUMENT.checked = false;
			GENERATE_ATL_DOCUMENT.disabled = true;
			GENERATE_ATL_DOCUMENT_LABEL.disabled = true;
			DOCUMENT_CLASS_NAME.disabled = true;
			DOCUMENT_CLASS_NAME_LABEL.disabled = true;
			DOCUMENT_HEADER_FILENAME.disabled = true;
			DOCUMENT_HEADER_FILENAME_LABEL.disabled = true;
			BrowseDocumentHeader.disabled = true;
		}

		if (DOCUMENT_CLASS_NAME.disabled) {
			DOCUMENT_CLASS_NAME.value = "";
		}

		if (DOCUMENT_HEADER_FILENAME.disabled) {
			DOCUMENT_HEADER_FILENAME.value = "";
		}

		OnGenATLDocChange();
	}

	function ValidateExtension(strExt) {
		if (strExt.indexOf("<") >= 0 || strExt.indexOf(">") >= 0 || strExt.indexOf("\"") >= 0 || strExt.indexOf(" ") >= 0 ||
			strExt.indexOf("/") >= 0 || strExt.indexOf("\\") >= 0 || strExt.indexOf("|") >= 0 || strExt.indexOf(":") >= 0 ||
			strExt.indexOf("?") >= 0 || strExt.indexOf("*") >= 0 || strExt.indexOf(".") >= 0) {
			return false;
		}
		return true;
	}

	function SetAndValidate() {
		if (!SUPPORT_MFC.checked && !GENERATE_ATL_DOCUMENT.checked && (THUMBNAIL_HANDLER.checked || SEARCH_HANDLER.checked || PREVIEW_HANDLER.checked)) {
			var L_Err_Text_MFC_ATL = "You must either specify MFC support or generate an ATL document.";
			window.external.ReportError(L_Err_Text_MFC_ATL);
			SUPPORT_MFC.focus();
			return false;
		}

		var strExtension = TrimStr(FILE_EXTENSION.value);
		if (strExtension != "" && !ValidateExtension(strExtension)) {
			var L_Err_Text = "您必须指定一个有效的文档文件扩展名。扩展名不能包含空格或以下任何字符: <>.\"\\/|:?*。";
			window.external.ReportError(L_Err_Text);
			FILE_EXTENSION.focus();
			return false;
		}

		if (strExtension != "" && !GENERATE_ATL_DOCUMENT.checked && (THUMBNAIL_HANDLER.checked || SEARCH_HANDLER.checked || PREVIEW_HANDLER.checked) && DOCUMENT_CLASS_NAME.value == "") {
			var L_DocName_Err_Text = "您必须提供现有文档类的名称。";
			window.external.ReportError(L_DocName_Err_Text);
			DOCUMENT_CLASS_NAME.focus();
			return false;
		}

		if (strExtension != "" && !GENERATE_ATL_DOCUMENT.checked && (THUMBNAIL_HANDLER.checked || SEARCH_HANDLER.checked || PREVIEW_HANDLER.checked) && DOCUMENT_HEADER_FILENAME.value == "") {
			var L_DocFile_Err_Text = "您必须提供现有文档类的头文件名称。";
			window.external.ReportError(L_DocFile_Err_Text);
			DOCUMENT_HEADER_FILENAME.focus();
			return false;
		}

		if (strExtension != "" && !GENERATE_ATL_DOCUMENT.checked && PREVIEW_HANDLER.checked && VIEW_CLASS_NAME.value == "") {
			var L_ViewName_Err_Text = "您必须提供现有视图类的名称。";
			window.external.ReportError(L_ViewName_Err_Text);
			VIEW_CLASS_NAME.focus();
			return false;
		}

		if (strExtension != "" && !GENERATE_ATL_DOCUMENT.checked && PREVIEW_HANDLER.checked && VIEW_HEADER_FILENAME.value == "") {
			var L_ViewFile_Err_Text = "您必须提供现有视图类的头文件名称。";
			window.external.ReportError(L_ViewFile_Err_Text);
			VIEW_HEADER_FILENAME.focus();
			return false;
		}

		if (strExtension != "" && GENERATE_ATL_DOCUMENT.checked && DOCUMENT_CLASS_NAME.value == "") {
			var L_DocClassName_Err_Text = "必须提供 ATL 文档类的类名称。";
			window.external.ReportError(L_DocClassName_Err_Text);
			DOCUMENT_CLASS_NAME.focus();
			return false;
		}

		if (DOCUMENT_CLASS_NAME.value != "") {
			TrimAndAdd("DOCUMENT_CLASS_NAME_SPECIFIED", "DOCUMENT_CLASS_NAME_TRIMMED", DOCUMENT_CLASS_NAME);
			if (PREVIEW_HANDLER.checked && VIEW_CLASS_NAME.value != "") {
				TrimAndAdd("VIEW_CLASS_NAME_SPECIFIED", "VIEW_CLASS_NAME_TRIMMED", VIEW_CLASS_NAME);
			}
		}

		if (GENERATE_ATL_DOCUMENT.checked) {
			TrimAndAdd("DOCUMENT_HEADER_FILENAME_SPECIFIED", "DOCUMENT_HEADER_FILENAME_TRIMMED", DOCUMENT_HEADER_FILENAME);
			TrimAndAdd("DOCUMENT_IMPL_FILENAME_SPECIFIED", "DOCUMENT_IMPL_FILENAME_TRIMMED", DOCUMENT_IMPL_FILENAME);
		}
		else {
			TrimAndAddFileName("DOCUMENT_HEADER_FILENAME_SPECIFIED", "DOCUMENT_HEADER_FILENAME_TRIMMED", DOCUMENT_HEADER_FILENAME);
			if (PREVIEW_HANDLER.checked) {
				TrimAndAddFileName("VIEW_HEADER_FILENAME_SPECIFIED", "VIEW_HEADER_FILENAME_TRIMMED", VIEW_HEADER_FILENAME);
			}
		}

		return true;
	}

	function TrimAndAddFileName(symbolbool, symboltrim, obj) {
		var strFileName = TrimStr(obj.value);
		var strNewFileName;

		if (strFileName != "") {
			if (window.external.FindSymbol("PROJECT_PATH")) {
				// try to build a relative path to the filename (so #includes will have relative paths)
				var strProjectPath = window.external.FindSymbol("PROJECT_PATH");

				// strip off the lowest level directory and compare.
				var nLength = strProjectPath.length;
				var nEndIndex = nLength - 1;
				if (strProjectPath.charAt(nEndIndex) == '\\') {
					nEndIndex = nEndIndex - 1;
				}
				while (nEndIndex > 0 && (strProjectPath.charAt(nEndIndex) != '\\')) {
					nEndIndex--;
				}

				var strCommonPath = strProjectPath.substring(0, nEndIndex + 1);
				var strCommonPathLower = strCommonPath.toLowerCase();
				var strFileNameSub = strFileName.substring(0, strCommonPath.length);
				var strFileNameSubLower = strFileNameSub.toLowerCase();
				if (strCommonPathLower == strFileNameSubLower) {
					strNewFileName = "..\\" + strFileName.substring(strCommonPath.length, strFileName.length);
				}
				else {
					// strip off the next lowest level directory and compare.
					if (strProjectPath.charAt(nEndIndex) == '\\') {
						nEndIndex = nEndIndex - 1;
					}
					while (nEndIndex > 0 && (strProjectPath.charAt(nEndIndex) != '\\')) {
						nEndIndex--;
					}

					var strCommonPath = strProjectPath.substring(0, nEndIndex + 1);
					var strCommonPathLower = strCommonPath.toLowerCase();
					var strFileNameSub = strFileName.substring(0, strCommonPath.length);
					var strFileNameSubLower = strFileNameSub.toLowerCase();
					if (strCommonPathLower == strFileNameSubLower) {
						strNewFileName = "..\\..\\" + strFileName.substring(strCommonPath.length, strFileName.length);
					}
				}
			}
		}

		if (strNewFileName != "") {
			window.external.AddSymbol(symboltrim, strNewFileName);
			window.external.AddSymbol(symbolbool, true);
		}
		else if (strFileName != "") {
			window.external.AddSymbol(symboltrim, strFileName);
			window.external.AddSymbol(symbolbool, true);
		}
		else {
			window.external.AddSymbol(symbolbool, false);
		}
	}

	function TrimAndAdd(symbolbool, symboltrim, obj) {
		var str = TrimStr(obj.value);

		if (str != "") {
			window.external.AddSymbol(symboltrim, str);
			window.external.AddSymbol(symbolbool, true);
		}
		else  {
			window.external.AddSymbol(symbolbool, false);
		}
	}

	function ToggleImage() {
		DLL_APP_IMAGE.style.display = "none";
		EXE_APP_IMAGE.style.display = "none";
		SERVICE_APP_IMAGE.style.display = "none";

		if (DLL_APP.checked) {
			DLL_APP_IMAGE.style.display = "block";
			return;
		}
		if (EXE_APP.checked) {
			EXE_APP_IMAGE.style.display = "block";
			return;
		}
		if (SERVICE_APP.checked)
			SERVICE_APP_IMAGE.style.display = "block";
	}

	function OnBrowseHeaderFile(obj) {
		var strFile;
		try {
			var L_Prompt1_Text = "选择头文件";
			var L_Prompt2_Text = "Visual C++ 头文件(*.h)\0*.h\0\0";
			var startDir = window.external.FindSymbol("PROJECT_PATH");
			if (startDir != "") {
				startDir += "\\..\\..";
			}
			strFile = window.external.GetExistingFileNameViaDlg(L_Prompt1_Text, startDir, L_Prompt2_Text, obj.value);
		}
		catch (e) {
			if (e.number != OLE_E_PROMPTSAVECANCELLED) {
				var L_ErrMsg2_Text = "OnBrowseHeaderFile() 中有错误";
				if (e.description.length != 0) {
					L_ErrMsg2_Text += ": ";
					L_ErrMsg2_Text += e.description;
				}
				window.external.ReportError(L_ErrMsg2_Text);
			}
			return;
		}
		obj.value = strFile;
	}

	function OnBrowseImplementationFile(obj) {
		var strFile;
		try {
			var L_Prompt3_Text = "选择实现文件";
			var L_Prompt4_Text = "Visual C++ 源文件(*.cpp)\0*.cpp\0\0";
			var startDir = window.external.FindSymbol("PROJECT_PATH");
			if (startDir != "") {
				startDir += "\\..\\..";
			}
			strFile = window.external.GetExistingFileNameViaDlg(L_Prompt3_Text, startDir, L_Prompt4_Text, obj.value);
		}
		catch (e) {
			if (e.number != OLE_E_PROMPTSAVECANCELLED) {
				var L_ErrMsg3_Text = "OnBrowseImplementationFile() 中有错误";
				if (e.description.length != 0) {
					L_ErrMsg3_Text += ": ";
					L_ErrMsg3_Text += e.description;
				}
				window.external.ReportError(L_ErrMsg3_Text);
			}
			return;
		}
		obj.value = strFile;
	}

	function OnDocClassNameChange() {
		var strClassName = TrimStr(DOCUMENT_CLASS_NAME.value);
		var strLen = strClassName.length;
		if (GENERATE_ATL_DOCUMENT.checked) {
			if (strLen) {
				if ((strClassName.substr(0, 1) == "C") && ((strLen == 1) || !(strClassName.charAt(1).toLowerCase() == strClassName.charAt(1)))) {
					if (strLen == 1) {
						DOCUMENT_HEADER_FILENAME.value = "";
						DOCUMENT_IMPL_FILENAME.value = "";
					}
					else {
						DOCUMENT_HEADER_FILENAME.value = strClassName.substr(1, strLen) + ".h";
						DOCUMENT_IMPL_FILENAME.value = strClassName.substr(1, strLen) + ".cpp";
					}
				}
				else {
					DOCUMENT_HEADER_FILENAME.value = strClassName + ".h";
					DOCUMENT_IMPL_FILENAME.value = strClassName + ".cpp";
				}
			}
			else {
				DOCUMENT_HEADER_FILENAME.value = "";
				DOCUMENT_IMPL_FILENAME.value = "";
			}
		}
	}

	function OnGenATLDocChange() {
		var genAtlDocChecked = GENERATE_ATL_DOCUMENT.checked;
		var strExt = window.external.FindSymbol("FILE_EXTENSION_SPECIFIED");
		if (strExt != "") {
			BrowseDocumentHeader.disabled = genAtlDocChecked || (!PREVIEW_HANDLER.checked && !THUMBNAIL_HANDLER.checked && !SEARCH_HANDLER.checked);
			DOCUMENT_IMPL_FILENAME.disabled = !genAtlDocChecked || (!PREVIEW_HANDLER.checked && !THUMBNAIL_HANDLER.checked && !SEARCH_HANDLER.checked);
			DOCUMENT_IMPL_FILENAME_LABEL.disabled = !genAtlDocChecked || (!PREVIEW_HANDLER.checked && !THUMBNAIL_HANDLER.checked && !SEARCH_HANDLER.checked);
			VIEW_CLASS_NAME.disabled = genAtlDocChecked || !PREVIEW_HANDLER.checked;
			VIEW_CLASS_NAME_LABEL.disabled = genAtlDocChecked || !PREVIEW_HANDLER.checked;
			VIEW_HEADER_FILENAME.disabled = genAtlDocChecked || !PREVIEW_HANDLER.checked;
			VIEW_HEADER_FILENAME_LABEL.disabled = genAtlDocChecked || !PREVIEW_HANDLER.checked;
			BrowseViewHeader.disabled = genAtlDocChecked || !PREVIEW_HANDLER.checked;
		}
		else {
			DOCUMENT_IMPL_FILENAME.disabled = true;
			DOCUMENT_IMPL_FILENAME_LABEL.disabled = true;
			VIEW_CLASS_NAME.disabled = true;
			VIEW_CLASS_NAME_LABEL.disabled = true;
			VIEW_HEADER_FILENAME.disabled = true;
			VIEW_HEADER_FILENAME_LABEL.disabled = true;
			BrowseViewHeader.disabled = true;
		}

		if (DOCUMENT_IMPL_FILENAME.disabled) {
			DOCUMENT_IMPL_FILENAME.value = "";
		}

		if (VIEW_CLASS_NAME.disabled) {
			VIEW_CLASS_NAME.value = "";
		}

		if (VIEW_HEADER_FILENAME.disabled) {
			VIEW_HEADER_FILENAME.value = "";
		}
	}

</script>

<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>

<script id="INCLUDE_COMMON" language="JSCRIPT"></script>

<script>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</script>

