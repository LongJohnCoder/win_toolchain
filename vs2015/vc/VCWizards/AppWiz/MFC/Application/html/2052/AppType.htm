<!-- Copyright (c) Microsoft Corporation. All rights reserved. -->
<html dir="LTR">
<head>
	<title>MFC 应用程序向导</title>
	<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	<meta http-equiv="MSThemeCompatible" content="Yes">
	<link id="LINKURL" rel="stylesheet" href="../../../../../2052/NewStyles.css">
</head>
<body bgcolor="BUTTONFACE" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"
	onload="InitDocument(document);" onkeydown="if (!bValidating) OnKey();" onkeypress="if (!bValidating) OnPress();">
	<table class="ONE" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
		<col class="LinkPane">
		<col>
		<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
		<tr valign="TOP">
			<td height="79" width="100%" colspan="2">
				<table class="TWO" border="0" cellpadding="0" cellspacing="0">
					<col width="12">
					<col>
					<col width="12">
					<tr>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12">
							&nbsp;
						</td>
						<td valign="TOP" height="12" width="12">
							&nbsp;
						</td>
						<td class="IMAGE" valign="BOTTOM" width="110" rowspan="2">
							<div class="SMALLA" id="SINGLE_DOC_IMAGE">
								<img class="SMALL" src="../../Images/SingleDocument.gif" width="98" height="70" alt="">
							</div>
							<div class="SMALL" id="MULTI_DOC_IMAGE">
								<img class="SMALL" src="..\..\Images\MultipleDocuments.gif" width="98" height="70"
									alt="">
							</div>
							<div class="SMALL" id="MULTI_DOC_TABBED_IMAGE">
								<img class="SMALL" src="..\..\Images\MDITabs.gif" width="98" height="70" alt="">
							</div>
							<div class="SMALL" id="DIALOG_IMAGE">
								<img class="SMALL" src="..\..\Images\Dialog.gif" width="98" height="70" alt="">
							</div>
							<div class="SMALL" id="MULTI_TOP_DOC_IMAGE">
								<img class="SMALL" src="..\..\Images\MultipleTopLevel.gif" width="108" height="70"
									alt="">
							</div>
							<div class="SMALL" id="VISUAL_STUDIO_STYLE">
								<img class="SMALL" src="..\..\Images\VSProjectStyle.gif" width="108" height="70"
									alt="">
							</div>
							<div class="SMALL" id="OFFICE_STYLE">
								<img class="SMALL" src="..\..\Images\OfficeProjectStyle.gif" width="108" height="70"
									alt="">
							</div>
						</td>
						<td valign="TOP" height="12" width="6" rowspan="2">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
						<td valign="TOP" height="65">
							<h4 class="HEAD" id="HEAD">
								应用程序类型</h4>
							<p class="SUBHEAD" id="SUBHEAD">
								为应用程序指定文档/视图体系结构支持、语言和界面样式
								选项。</p>
						</td>
						<td valign="TOP" height="65" width="12">
							&nbsp;
						</td>
					</tr>
					<tr>
						<td valign="TOP" class="RULE" colspan="5" height="2">
							<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
								<tr valign="TOP">
									<td height="1" width="100%" bgcolor="BUTTONSHADOW">
									</td>
									<td height="1" width="1" bgcolor="WINDOW">
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
		<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
		<tr valign="TOP">
			<td class="Three" valign="TOP" height="100%" width="100%">
				<table class="fixedSize" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
					<tr valign="TOP">
						<td class="threeCustom" valign="TOP">
							<!--OPEN OF NAVIGATION TABLE//-->
							<table class="THREE" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="1">
								<tr>
									<td valign="TOP" colspan="3" height="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="100%">
										&nbsp;
									</td>
									<td valign="TOP" height="100%">
										<!--OPEN OF NAVIGATIONAL LINKS//-->
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="Default" title="查看所选内容的概述。"
															onclick="Next(document, 'Default.htm');" tabindex="1">概述</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINKSELECTED">
											<span class="VERTLINE1">
												<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
											</span><span class="HORILINE1">
												<table width="167" height="100%" border="0" cellpadding="0" cellspacing="0">
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
													<tr valign="TOP">
														<td height="100%">
															<img src="../../../../../1033/Images/spacer.gif" width="165" height="28" alt="" border="0">
														</td>
													</tr>
													<tr valign="TOP">
														<td class="DOTTEDLINE" height="1">
														</td>
													</tr>
												</table>
											</span>
											<table width="160" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXTSELECTED">
												<tr valign="MIDDLE">
													<td width="100%">
														<span id="AppType" title="为应用程序指定文档/视图结构支持、语言和界面样式选项。">
															应用程序类型</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXTINDENT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="CompoundDoc" title="指定 OLE 容器或服务器选项以及活动文档支持。"
															onclick="onClick(this);" tabindex="2">复合文档支持</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXTINDENT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="DocTemp" title="指定在创建新文档时应用程序文档模板要使用的值。"
															onclick="onClick(this);" tabindex="3">文档模板属性</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="DBSupport" title="指定数据库支持，包括任何数据源。"
															onclick="onClick(this);" tabindex="4">数据库支持</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="UIFeatures" title="指定控制应用程序外观的选项。"
															onclick="Next(document, 'UIFeatures.htm');" tabindex="5">用户界面功能</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="Advanced" title="指定将置入应用程序中的附加支持。"
															onclick="Next(document, 'Advanced.htm');" tabindex="6">高级功能</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<div class="LINK">
											<table width="100%" height="28" border="0" cellpadding="0" cellspacing="0" class="LINKTEXT">
												<tr valign="MIDDLE">
													<td width="100%">
														<span class="ACTIVELINK" id="GeneratedClasses" title="查看已生成的类并为应用程序指定基类。"
															onclick="Next(document, 'GeneratedClasses.htm');" tabindex="7">生成的类</span>
													</td>
													<td width="4">
														<img src="../../../../../1033/Images/spacer.gif" height="1" width="4">
													</td>
												</tr>
											</table>
										</div>
										<!--CLOSE OF NAVIGATIONAL LINKS//-->
									</td>
									<td width="1">
										<div class="VERTLINE">
											<img src="../../../../../1033/Images/spacer.gif" width="1" height="1" alt="" border="0">
										</div>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION TABLE//-->
			</td>
			<td valign="TOP" height="100%">
				<!--OPEN OF CONTENT AND BUTTON TABLE//-->
				<table class="ONE" border="0" cellpadding="0" cellspacing="0">
					<col width="100%">
					<tr valign="TOP">
						<td height="100%">
							<!--OPEN OF CONTENT//-->
							<table class="CONTENT" border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="12">
								<col>
								<col width="12">
								<tr>
									<td valign="TOP" height="12" colspan="5">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP">
										<span class="itemTextTop" id="applicationType_title">应用程序类型: 
											<p class="Spacer">
												&nbsp;</p>
											<input type="radio" class="Radio" name="apptype" id="APP_TYPE_SDI" accesskey="s"
												title="选择具有单文档界面(SDI)支持的应用程序。" onclick="OnAppType();">
											<div class="itemTextRadioB" title="选择具有单文档界面(SDI)支持的应用程序。"
												id="APP_TYPE_SDI_DIV">
												<label id="SINGLEDOC_TEXT" for="APP_TYPE_SDI">单个文档(<u>S</u>)</label>
											</div>
											<br>
											<input type="radio" class="Radio" name="apptype" id="APP_TYPE_MDI" accesskey="m"
												title="选择在一个顶级框架窗口内支持多文档界面(MDI)的应用程序。"
												onclick="OnAppType();">
											<div class="itemTextRadioB" id="SELECT_MULTIDOC_TEXT" title="选择在一个顶级框架窗口内支持多文档界面(MDI)的应用程序。">
												<label id="MULTIDOC_TEXT" for="APP_TYPE_MDI">多个文档(<u>M</u>)</label>
											</div>
											<br>
											<input type="checkbox" class="CheckboxIndent" accesskey="b" id="APP_TYPE_TABBED_MDI"
												title="使用可以组合在一起的多个选项卡式文档(Visual Studio 样式)。"
												onpropertychange="OnAppType();">
											<div class="itemTextCheckboxIndentB" id="SELECT_TABBED_MULTIDOC_TEXT" title="使用可以组合在一起的多个选项卡式文档(Visual Studio 样式)。">
												<label id="APP_TYPE_TABBED_MDI_LABEL" for="APP_TYPE_TABBED_MDI">选项卡式文档(<u>B</u>)</label>
											</div>
											<p class="ElementSpacer">
												&nbsp;</p>
											<input type="radio" class="Radio" name="apptype" id="APP_TYPE_DLG" accesskey="d"
												title="选择在对话框中运行的应用程序。" onclick="OnAppType();">
											<div class="itemTextRadioB" id="SELECT_DIALOG_TEXT" title="选择在对话框中运行的应用程序。">
												<label id="DIALOG_TEXT" for="APP_TYPE_DLG">基于对话框(<u>D</u>)</label>
											</div>
											<br>
											<input type="checkbox" class="CheckboxIndent" accesskey="i" id="HTML_DIALOG" title="从 CDHtmlDialog 派生对话框类。"
												onpropertychange="OnDHTMLDialogSupport();">
											<div class="itemTextCheckboxIndentB" id="HTML_DIALOG_DIV" title="从 CDHtmlDialog 派生对话框类。">
												<label id="HTML_DIALOG_LABEL" for="HTML_DIALOG">使用 HTML 对话框(<u>I</u>)</label>
											</div>
											<br>
											<input type="checkbox" class="CheckboxIndent" accesskey="o" id="NO_MFC_CONTROLS" title="不允许在对话框中使用增强的 MFC 控件(会缩小静态链接的应用程序的大小)。"
												onpropertychange="OnMFCControls();">
											<div class="itemTextCheckboxIndentB" id="NO_MFC_CONTROLS_DIV" title="不允许在对话框中使用增强的 MFC 控件(会缩小静态链接的应用程序的大小)。">
												<label id="NO_MFC_CONTROLS_LABEL" for="NO_MFC_CONTROLS">无增强的 MFC 控件(<u>O</u>)</label>
											</div>
											<p class="ElementSpacer">
												&nbsp;</p>
											<input type="radio" class="Radio" name="apptype" id="APP_TYPE_MTLD" accesskey="t"
												title="选择支持多个顶级框架窗口的应用程序类型。"
												onclick="OnAppType();">
											<div class="itemTextRadioB" id="SELECT_MULTI_TEXT" title="选择支持多个顶级框架窗口的应用程序类型。">
												<label id="MULTI_TEXT" for="APP_TYPE_MTLD">多个顶级文档(<u>T</u>)</label>
											</div>
										</span>
										<p class="ElementSpacer">
											&nbsp;</p>
										<span class="itemText" id="docview_title">
											<input class="CheckBox" type="checkbox" id="DOCVIEW" accesskey="v" title="指定使用 CDocument 和 CView 基类在应用程序内生成文档/视图结构。"
												onpropertychange="OnDocView();" class="SINGLECHECKBOX">
											<div class="itemTextCheckboxA" id="SELECT_DOCVIEW_TEXT" title="指定使用 CDocument 和 CView 基类在应用程序内生成文档/视图结构。">
												<label id="DOCVIEW_TEXT" for="DOCVIEW">文档/视图结构支持(<u>V</u>)</label>
											</div>
										</span>
										<p class="ElementSpacer">
											&nbsp;</p>
										<span class="itemText" id="sdl_check_title">
											<input class="CheckBox" type="checkbox" id="SDL_CHECK" accesskey="C" title="启用附加安全开发生命周期(SDL)检查。"
												onpropertychange="OnAppType();" class="SINGLECHECKBOX">
											<div class="itemTextCheckboxA" id="SDL_CHECK_DIV" title="启用附加安全开发生命周期(SDL)检查。">
												<label id="SDL_CHECK_LABEL" for="SDL_CHECK">安全开发生命周期(SDL)检查(<U>C</U>)</label>
											</div>
										</span>
										<p class="ElementSpacer18">
											&nbsp;</p>
										<span class="itemText" id="SPEC_LANGUAGE_TEXT" title="指定用于应用程序资源的语言。">
											<label id="LANGUAGE_TEXT" for="LANGUAGE">资源语言(<u>L</u>): </label>
											<br>
											<select class="sideBtn" size="1" id="LANGUAGE" accesskey="l" onchange="OnLang();"
												title="指定用于应用程序资源的语言。">
											</select>
										</span>
									</td>
									<td valign="TOP" width="12">
										&nbsp;
									</td>
									<td valign="TOP">
										<span class="itemTextTop" id="projectType_title">项目类型: 
											<p class="Spacer">
												&nbsp;</p>
											<input type="radio" class="Radio" accesskey="a" title="选择传统风格的用户界面。"
												name="projtype" value="radiobutton" id="PROJECT_STYLE_MFCSTD" onclick="OnProjectStyle();">
											<div class="itemTextRadioB" id="SELECT_UI_TEXT" title="选择传统风格的用户界面。">
												<label id="UI_TEXT" for="PROJECT_STYLE_MFCSTD">MFC 标准(<u>A</u>)</label>
											</div>
											<br>
											<input type="radio" class="Radio" accesskey="x" title="选择浏览器样式的用户界面。"
												name="projtype" value="radiobutton" id="PROJECT_STYLE_EXPLORER" onclick="OnProjectStyle();">
											<div class="itemTextRadioB" id="explorer_title" title="选择浏览器样式的用户界面。">
												<label id="EXPLORER_TEXT" for="PROJECT_STYLE_EXPLORER">Windows 资源管理器(<u>X</u>)</label>
											</div>
											<br>
											<input type="radio" class="Radio" accesskey="o" title="选择 Visual Studio 样式的用户界面(具有资源管理器窗格、输出窗格和属性窗格)。"
												name="projtype" value="radiobutton" id="PROJECT_STYLE_VISUALSTUDIO" onclick="OnProjectStyle();">
											<div class="itemTextRadioB" id="visualstudio_title" title="选择 Visual Studio 样式的用户界面(具有资源管理器窗格、输出窗格和属性窗格)。">
												<label id="VISUALSTUDIO_TEXT" for="PROJECT_STYLE_VISUALSTUDIO">Visual Studio(<u>O</u>)</label>
											</div>
											<br>
											<input type="radio" class="Radio" accesskey="f" title="选择 Office 样式的用户界面(具有功能区、导航窗格和标题栏)。"
												name="projtype" value="radiobutton" id="PROJECT_STYLE_OFFICE" onclick="OnProjectStyle();">
											<div class="itemTextRadioB" id="office_title" title="选择 Office 样式的用户界面(具有功能区、导航窗格和标题栏)。">
												<label id="OFFICE_TEXT" for="PROJECT_STYLE_OFFICE">Office(<u>F</u>)</label>
											</div>
										</span>
										<p class="ElementSpacer">
											&nbsp;</p>
										<span class="itemTextTop" id="appearance_title" title="指定应用程序的视觉样式和颜色。">
											<label id="VISUAL_STYLE_COMBO_LABEL" for="VISUAL_STYLE_COMBO">视觉样式和颜色(<u>Y</u>): </label>
											<br>
											<select class="sidebtnNoWidth" id="VISUAL_STYLE_COMBO" accesskey="y" title="指定应用程序的视觉样式和颜色。"
												onchange="OnAppearance(this);" size="1">
												<option id="DEFMFC_LOOK" value="DEFMFC_LOOK">Windows 本机/默认</option>
												<option id="OFF2003_LOOK" value="OFF2003_LOOK">Office 2003</option>
												<option id="VS2005_LOOK" value="VS2005_LOOK" selected>Visual Studio 2005</option>
												<option id="VS2008_LOOK" value="VS2008_LOOK" selected>Visual Studio 2008</option>
												<option id="OFF2007_BLUE" value="OFF2007_BLUE">Office 2007 (蓝色主题)</option>
												<option id="OFF2007_BLACK" value="OFF2007_BLACK">Office 2007 (黑色主题)</option>
												<option id="OFF2007_SILVER" value="OFF2007_SILVER">Office 2007 (银色主题)</option>
												<option id="OFF2007_AQUA" value="OFF2007_AQUA">Office 2007 (浅绿色主题)</option>
												<option id="WINDOWS_7" value="WINDOWS_7">Windows 7</option>
											</select>
											<br>
											<p class="ElementSpacer2">
												&nbsp;</p>
											<input type="checkbox" class="CheckBoxA" accesskey="c" id="ENABLE_VISUAL_STYLE_SWITCHING"
												title="启用在运行时切换应用程序视觉样式和颜色。">
											<div class="itemTextCheckboxB" id="enable_visual_style_switching_label" title="启用在运行时切换应用程序视觉样式和颜色。">
												<label id="ENABLE_VISUAL_STYLE_SWITCHING_LABEL" for="ENABLE_VISUAL_STYLE_SWITCHING">启用视觉样式切换(<u>C</u>)</label>
											</div>
										</span>
										<p class="ElementSpacer">
											&nbsp;</p>
										<span class="itemTextTop" id="projectType_title2">MFC 的使用: 
											<p class="Spacer">
												&nbsp;</p>
											<input type="radio" class="Radio" accesskey="u" title="与 MFC DLL 链接。" name="useofmfc"
												id="DYNAMIC_MFC">
											<div class="itemTextRadioB" id="LINK_MFC_DYNAMIC_TEXT" title="与 MFC DLL 链接。">
												<label id="DYNAMIC_MFC_TEXT" for="DYNAMIC_MFC">在共享 DLL 中使用 MFC(<u>U</u>)</label>
											</div>
											<br>
											<input type="radio" class="Radio" accesskey="e" title="与 MFC 静态库链接。"
												name="useofmfc" value="radiobutton" id="STATIC_MFC">
											<div class="itemTextRadioB" id="LINK_MFC_STATIC_TEXT" title="与 MFC 静态库链接。">
												<label id="STATIC_MFC_TEXT" for="STATIC_MFC">在静态库中使用 MFC(<u>E</u>)</label>
											</div>
										</span>
									</td>
								</tr>
							</table>
							<!--CLOSE OF CONTENT//-->
						</td>
					</tr>
					<tr valign="BOTTOM">
						<td>
							<!--OPEN OF BUTTON HTML//-->
							<table border="0" cellpadding="0" cellspacing="0">
								<col width="12">
								<col>
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="4">
								<col width="75">
								<col width="12">
								<tr>
									<td valign="TOP" class="RULE" colspan="8" height="2">
										<table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
											<tr valign="TOP">
												<td height="1" width="100%" bgcolor="BUTTONSHADOW">
												</td>
												<td height="1" width="1" bgcolor="WINDOW">
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="11" colspan="8">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
									<td valign="TOP" height="23">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="FinishBtn" onclick="OnFinish(document);">
											完成</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="CancelBtn" onclick="window.external.Finish(document, 'cancel');">
											取消</button>
									</td>
									<td valign="MIDDLE" height="23" width="4">
										&nbsp;
									</td>
									<td valign="MIDDLE" height="23" width="75">
										<button class="BUTTONS" id="HelpBtn" onclick="window.external.OnHelp('vc.appwiz.mfc.exe.apptype');">
											帮助</button>
									</td>
									<td valign="MIDDLE" height="23" width="12">
										&nbsp;
									</td>
								</tr>
								<tr>
									<td valign="TOP" height="12" colspan="8">
										&nbsp;
									</td>
								</tr>
							</table>
							<!--CLOSE OF BUTTON HTML//-->
						</td>
					</tr>
				</table>
				<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
			</td>
		</tr>
	</table>
</body>
</html>

<script language="JSCRIPT">

	var tab_array = new Array();
	tab_array[0] = Default;
	tab_array[1] = AppType;
	tab_array[2] = CompoundDoc;
	tab_array[3] = DocTemp;
	tab_array[4] = DBSupport;
	tab_array[5] = UIFeatures;
	tab_array[6] = Advanced;
	tab_array[7] = GeneratedClasses;

	function InitDocument(document) {
		setDirection();
		InitTabs();
		window.external.Load(document);
		PopulateLanguages();
		OnLang();

		ToggleImage();
		SetFocus();

		APP_TYPE_TABBED_MDI.disabled = false;
		APP_TYPE_TABBED_MDI_LABEL.disabled = false;
		VISUAL_STYLE_COMBO.disabled = false;
		appearance_title.disabled = false;
		ENABLE_VISUAL_STYLE_SWITCHING.disabled = false;
		enable_visual_style_switching_label.disabled = false;

		if (!APP_TYPE_MDI.checked) {
			APP_TYPE_TABBED_MDI.disabled = true;
			APP_TYPE_TABBED_MDI_LABEL.disabled = true;
		}
		else {
			if (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == true) {
				APP_TYPE_TABBED_MDI.checked = false;
			}
		}

		if (!APP_TYPE_DLG.checked) {
			HTML_DIALOG.disabled = true;
			HTML_DIALOG_LABEL.disabled = true;
			NO_MFC_CONTROLS.disabled = true;
			NO_MFC_CONTROLS_LABEL.disabled = true;
	}

		if ((window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == true) || window.external.FindSymbol("APP_TYPE_DLG")) {
			VISUAL_STYLE_COMBO.value = "DEFMFC_LOOK";
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = true;
			enable_visual_style_switching_label.disabled = true;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = false;

			PROJECT_STYLE_MFCSTD.checked = true;
			PROJECT_STYLE_EXPLORER.checked = false;
			PROJECT_STYLE_VISUALSTUDIO.checked = false;
			PROJECT_STYLE_OFFICE.checked = false;
		}
	}

	function PopulateLanguages() {
		var oLangList = document.all.tags("SELECT").item("LANGUAGE");

		// Scan the templates directory for the available languages
		//
		var strInstalledLangs = window.external.GetInstalledLangs();

		// Populate the list
		//
		var iBegin = 0;
		var iEnd = 0;
		while (iEnd >= 0) {
			var strLangId;
			iEnd = strInstalledLangs.indexOf(",", iBegin);
			if (iEnd >= 0) {
				strLangId = strInstalledLangs.substr(iBegin, iEnd - iBegin);
				iBegin = iEnd + 1;
			}
			else {
				strLangId = strInstalledLangs.substr(iBegin);
			}
			var oOption = document.createElement("OPTION");
			oOption.value = strLangId;
			oOption.text = window.external.GetLangFromLCID(strLangId);
			oLangList.add(oOption);
		}
		var len = oLangList.options.length;

		var bIsDBCS = false;
		var strProjName = window.external.FindSymbol("PROJECT_NAME");
		for (i = 0; i < strProjName.Length; i++) {
			if (strProjName.charCodeAt(i) > 255) {
				bIsDBCS = true;
				break;
			}
		}

		if (bIsDBCS) {
			var strSystemLocale = window.external.GetSystemLCID();
			for (i = 0; i < len; i++) {
				var val = oLangList.options[i].value;
				if (val == strSystemLocale) {
					oLangList.selectedIndex = i;
					break;
				}
			}
			oLangList.disable = true;
			return;
		}


		var strHostLocale = window.external.FindSymbol("LCID");

		if (strHostLocale == "") {
			strHostLocale = window.external.GetHostLocale();
		}
		var strHostLocalePrimary = window.external.GetPrimaryLangIdFromLCID(strHostLocale);
		var strSystemLocale = window.external.GetSystemLCID();
		var strSystemLocalePrimary = window.external.GetPrimaryLangIdFromLCID(strSystemLocale);
		var nEnglishUSIndex = 0;
		var nBestPrimaryMatch = -1;
		var nSystemLocaleMatch = -1;

		for (i = 0; i < len; i++) {
			var val = oLangList.options[i].value;

			// If the language of the VS Envrionment is running in
			// is available it should default to that language.
			if (val == strHostLocale) {
				oLangList.selectedIndex = i;
				return;
			}

			// remember the match on system locale, if host locale not found
			if (val == strSystemLocale) {
				nSystemLocaleMatch = i;
			}

			// Remember the best match based on primary langid (i.e. "English")
			// So that if the System/Host locale are "English (United Kindom)"
			// and the only installed one is "English (United States)", we will match.
			if (window.external.GetPrimaryLangIdFromLCID(val) == strHostLocalePrimary ||
			window.external.GetPrimaryLangIdFromLCID(val) == strSystemLocalePrimary) {
				nBestPrimaryMatch = i;
			}

			if (val == "1033") {
				nEnglishUSIndex = i;
			}

		}

		//
		// If the language that the system is running in
		// (system default locale) is available it should
		// default to that resource language.
		//

		if (nSystemLocaleMatch != -1)
			oLangList.selectedIndex = nSystemLocaleMatch;

		// If the language that the system is running in
		// (system default locale) is *not* available it
		// should default to English (available on all installs)
		//
		else if (nBestPrimaryMatch != -1)
			oLangList.selectedIndex = nBestPrimaryMatch;

		else
			oLangList.selectedIndex = nEnglishUSIndex;
	}

	function InitTabs() {
		MouseOut(DBSupport);
		MouseOut(CompoundDoc);
		MouseOut(DocTemp);
	}

	function Next(document, linkto) {
		window.external.Next(document, linkto);
	}

	function onClick(obj) {
		if (obj == null || typeof (obj) == "undefined")
			return;

		if (obj.id == "DBSupport") {
			if (!APP_TYPE_DLG.checked) {
				Next(document, "DBSupport.htm");
			}
		}
		if (obj.id == "CompoundDoc") {
			if (DOCVIEW.checked && !DOCVIEW.disabled) {
				Next(document, "CompoundDoc.htm");
			}
		}
		if (obj.id == "DocTemp") {
			if (DOCVIEW.checked && !DOCVIEW.disabled) {
				Next(document, "DocTemp.htm");
			}
		}
	}

	function CheckDataSource() {
		if (window.external.FindSymbol("DB_CONNECTION_STRING") == "" && (window.external.FindSymbol("OLEDB") || window.external.FindSymbol("ODBC"))) {
			L_Err1_Text = "选择数据库视图选项时必须指定数据源";
			window.external.ReportError(L_Err1_Text);
			return false;
		}
		return true;
	}

	function OnFinish(document) {
		if (!CheckDataSource())
			return;

		if (window.external.FindSymbol("ACTIVE_DOC_SERVER")) {
			if (window.external.FindSymbol("FILE_EXTENSION") == "") {
				L_Err2_Text = "您必须在“文档模板属性”页中指定文档文件扩展名";
				window.external.ReportError(L_Err2_Text);
				return;
			}
		}
		OnWizFinish(document);
	}

	function OnAppType() {
		DBSupport.className = "activelink";
		DOCVIEW.disabled = false;
		docview_title.disabled = false;
		SDL_CHECK.disabled = false;
		sdl_check_title.disabled = false;
		PROJECT_STYLE_EXPLORER.disabled = false;
		explorer_title.disabled = false;
		PROJECT_STYLE_VISUALSTUDIO.disabled = false;
		visualstudio_title.disabled = false;
		PROJECT_STYLE_OFFICE.disabled = false;
		office_title.disabled = false;

		if (APP_TYPE_MDI.checked) {
			APP_TYPE_TABBED_MDI.disabled = false;
			APP_TYPE_TABBED_MDI_LABEL.disabled = false;

			if (window.external.FindSymbol("DB_VIEW_NO_FILE")) {
				var L_Prompt1_Text = "选择“多文档界面”将使项目包含文件支持。";
				if (window.external.YesNoAlert(L_Prompt1_Text)) {
					window.external.AddSymbol("DB_VIEW_NO_FILE", false);
					window.external.AddSymbol("DB_VIEW_WITH_FILE", true);
				}
				else {
					APP_TYPE_MDI.checked = false;
					APP_TYPE_SDI.checked = true;
				}
			}
		}
		else {
			APP_TYPE_TABBED_MDI.disabled = true;
			APP_TYPE_TABBED_MDI.checked = false;
			APP_TYPE_TABBED_MDI_LABEL.disabled = true;
		}

		if (APP_TYPE_DLG.checked) {
			window.external.AddSymbol("DIALOG_BASE_CLASS", "CDialogEx");

			HTML_DIALOG.disabled = false;
			HTML_DIALOG_LABEL.disabled = false;
			NO_MFC_CONTROLS.disabled = false;
			NO_MFC_CONTROLS_LABEL.disabled = false;
			DOCVIEW.disabled = true;
			docview_title.disabled = true;
			OnDocView();
			DBSupport.className = "inactivelink";

			PROJECT_STYLE_EXPLORER.disabled = true;
			explorer_title.disabled = true;
			PROJECT_STYLE_EXPLORER.checked = false;
			PROJECT_STYLE_VISUALSTUDIO.disabled = true;
			visualstudio_title.disabled = true;
			PROJECT_STYLE_VISUALSTUDIO.checked = false;
			PROJECT_STYLE_OFFICE.disabled = true;
			office_title.disabled = true;
			PROJECT_STYLE_OFFICE.checked = false;

			window.external.AddSymbol("LIST_VIEW", false);
			if (window.external.FindSymbol("VIEW_BASE_CLASS") != "CView")
				window.external.AddSymbol("VIEW_BASE_CLASS", "CView");

			PROJECT_STYLE_MFCSTD.checked = true;
			VISUAL_STYLE_COMBO.value = "DEFMFC_LOOK";
			VISUAL_STYLE_COMBO.disabled = true;
			VISUAL_STYLE_COMBO_LABEL.disabled = true;
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = true;
			enable_visual_style_switching_label.disabled = true;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = false;

			window.external.AddSymbol("DB_SUPPORT_NONE", true);
			window.external.AddSymbol("DB_SUPPORT_HEADER_ONLY", false);
			window.external.AddSymbol("DB_VIEW_NO_FILE", false);
			window.external.AddSymbol("DB_VIEW_WITH_FILE", false);
			window.external.AddSymbol("OLEDB", false);
			window.external.AddSymbol("ODBC", false);
			window.external.AddSymbol("DB_SUPPORT_INFO", "");
			window.external.AddSymbol("DB_CONNECTION_STRING", "");
			window.external.AddSymbol("OLEDB_RECORD_VIEW", false);
			window.external.AddSymbol("ODBC_RECORD_VIEW", false);
			window.external.AddSymbol("VIEW_BASE_CLASS", "CView");

			window.external.AddSymbol("COMPOUND_DOC_NONE", true);
			window.external.AddSymbol("CONTAINER", false);
			window.external.AddSymbol("MINI_SERVER", false);
			window.external.AddSymbol("FULL_SERVER", false);
			window.external.AddSymbol("CONTAINER_SERVER", false);
			window.external.AddSymbol("ACTIVE_DOC_CONTAINER", false);
			window.external.AddSymbol("ACTIVE_DOC_SERVER", false);
			window.external.AddSymbol("MAIN_FRAME_MINIMIZE_BOX", false);
			window.external.AddSymbol("MAIN_FRAME_MAXIMIZE_BOX", false);
			window.external.AddSymbol("MAIN_FRAME_THICK_FRAME", false);
		}
		else {
			HTML_DIALOG.disabled = true;
			HTML_DIALOG.checked = false;
			HTML_DIALOG_LABEL.disabled = true;
			NO_MFC_CONTROLS.disabled = true;
			NO_MFC_CONTROLS.checked = false;
			NO_MFC_CONTROLS_LABEL.disabled = true;
			window.external.AddSymbol("MAIN_FRAME_MINIMIZE_BOX", true);
			window.external.AddSymbol("MAIN_FRAME_MAXIMIZE_BOX", true);
			window.external.AddSymbol("MAIN_FRAME_THICK_FRAME", true);

			VISUAL_STYLE_COMBO.disabled = false;
			VISUAL_STYLE_COMBO_LABEL.disabled = false;
		}

		if (APP_TYPE_SDI.checked || APP_TYPE_MTLD.checked) {
			if (window.external.FindSymbol("MENUBAR_TOOLBAR") || window.external.FindSymbol("RIBBON_TOOLBAR")) {
				window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CFrameWndEx");
				window.external.AddSymbol("APP_BASE_CLASS", "CWinAppEx");
			}
			else {
				window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CFrameWnd");
				window.external.AddSymbol("APP_BASE_CLASS", "CWinApp");
			}
		}
		else if (APP_TYPE_TABBED_MDI.checked) {
			window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CMDIFrameWndEx");
			window.external.AddSymbol("CHILD_FRAME_BASE_CLASS", "CMDIChildWndEx");
			window.external.AddSymbol("APP_BASE_CLASS", "CWinAppEx");

			if (PROJECT_STYLE_OFFICE.checked) {
				if (window.external.FindSymbol("MENUBAR_TOOLBAR") == false) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else {
				if (window.external.FindSymbol("RIBBON_TOOLBAR") == false) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", true);
					window.external.AddSymbol("RIBBON_TOOLBAR", false);
				}
			}
		}
		else if (APP_TYPE_MDI.checked && (window.external.FindSymbol("RIBBON_TOOLBAR") || window.external.FindSymbol("MENUBAR_TOOLBAR"))) {
			window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CMDIFrameWndEx");
			window.external.AddSymbol("CHILD_FRAME_BASE_CLASS", "CMDIChildWndEx");
			window.external.AddSymbol("APP_BASE_CLASS", "CWinAppEx");
		}
		else if (APP_TYPE_MDI.checked) {
			window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CMDIFrameWnd");
			window.external.AddSymbol("CHILD_FRAME_BASE_CLASS", "CMDIChildWnd");
			window.external.AddSymbol("APP_BASE_CLASS", "CWinApp");
		}
		else if (APP_TYPE_DLG.checked) {
			window.external.AddSymbol("APP_BASE_CLASS", "CWinApp");
		}

		if (!DOCVIEW.checked || DOCVIEW.disabled) {
			PROJECT_STYLE_EXPLORER.disabled = true;
			explorer_title.disabled = true;
			PROJECT_STYLE_EXPLORER.checked = false;
			PROJECT_STYLE_VISUALSTUDIO.disabled = true;
			visualstudio_title.disabled = true;
			PROJECT_STYLE_VISUALSTUDIO.checked = false;
			PROJECT_STYLE_OFFICE.disabled = true;
			office_title.disabled = true;
			PROJECT_STYLE_OFFICE.checked = false;

			window.external.AddSymbol("LIST_VIEW", false);
			if (window.external.FindSymbol("VIEW_BASE_CLASS") != "CView")
				window.external.AddSymbol("VIEW_BASE_CLASS", "CView");
		}

		ToggleImage();
	}

	function OnDocView() {
		if (!DOCVIEW.checked && !DOCVIEW.disabled &&
	 (window.external.FindSymbol("DB_VIEW_NO_FILE") ||
	  window.external.FindSymbol("DB_VIEW_WITH_FILE") ||
	 (window.external.FindSymbol("COMPOUND_DOC_NONE") == false) ||
	 (window.external.FindSymbol("AUTOMATION") == true) ||
	 (window.external.FindSymbol("SPLITTER") == true) ||
	 (window.external.FindSymbol("MAPI") == true)
	 )) {
			var L_Prompt2_Text = "移除文档/视图结构支持将禁用对以下项的支持:\n";
			var L_Prompt21_Text = "\n\t- 数据库视图";
			var L_Prompt22_Text = "\n\t- 复合文档";
			var L_Prompt23_Text = "\n\t- 自动化";
			var L_Prompt24_Text = "\n\t- 拆分窗口";
			var L_Prompt25_Text = "\n\t- MAPI (消息传递 API)";
			var L_Prompt26_Text = "\n\n是否继续?";
			var General_Prompt = L_Prompt2_Text;
			if (window.external.FindSymbol("DB_VIEW_NO_FILE") || window.external.FindSymbol("DB_VIEW_WITH_FILE")) {
				General_Prompt = General_Prompt + L_Prompt21_Text;
			}
			if (window.external.FindSymbol("COMPOUND_DOC_NONE") == false) {
				General_Prompt = General_Prompt + L_Prompt22_Text;
			}

			if (window.external.FindSymbol("AUTOMATION") == true) {
				General_Prompt = General_Prompt + L_Prompt23_Text;
			}

			if (window.external.FindSymbol("SPLITTER") == true) {
				General_Prompt = General_Prompt + L_Prompt24_Text;
			}

			if (window.external.FindSymbol("MAPI") == true) {
				General_Prompt = General_Prompt + L_Prompt25_Text;
			}

			if (window.external.YesNoAlert(General_Prompt + L_Prompt26_Text)) {
				window.external.AddSymbol("DB_SUPPORT_NONE", true);
				window.external.AddSymbol("DB_SUPPORT_HEADER_ONLY", false);
				window.external.AddSymbol("DB_VIEW_NO_FILE", false);
				window.external.AddSymbol("DB_VIEW_WITH_FILE", false);
				window.external.AddSymbol("OLEDB", false);
				window.external.AddSymbol("ODBC", false);
				window.external.AddSymbol("DB_SUPPORT_INFO", "");
				window.external.AddSymbol("DB_CONNECTION_STRING", "");
				window.external.AddSymbol("OLEDB_RECORD_VIEW", false);
				window.external.AddSymbol("ODBC_RECORD_VIEW", false);
				window.external.AddSymbol("VIEW_BASE_CLASS", "CView");
				window.external.AddSymbol("CONTAINER_ITEM_BASE_CLASS", false);
				window.external.AddSymbol("SERVER_ITEM_BASE_CLASS", false);
				window.external.AddSymbol("COMPOUND_DOC_NONE", true);
				window.external.AddSymbol("CONTAINER", false);
				window.external.AddSymbol("MINI_SERVER", false);
				window.external.AddSymbol("FULL_SERVER", false);
				window.external.AddSymbol("CONTAINER_SERVER", false);
				window.external.AddSymbol("ACTIVE_DOC_CONTAINER", false);
				window.external.AddSymbol("ACTIVE_DOC_SERVER", false);
				window.external.AddSymbol("AUTOMATION", false);
				window.external.AddSymbol("MAPI", false);
				window.external.AddSymbol("SPLITTER", false);
			}
			else {
				DOCVIEW.checked = true;
			}
		}

		CompoundDoc.className = "activelink";
		DocTemp.className = "activelink";

		if (!DOCVIEW.checked || DOCVIEW.disabled) {
			CompoundDoc.className = "inactivelink";

			DocTemp.className = "inactivelink";
			PROJECT_STYLE_EXPLORER.disabled = true;
			explorer_title.disabled = true;
			PROJECT_STYLE_EXPLORER.checked = false;
			PROJECT_STYLE_VISUALSTUDIO.disabled = true;
			visualstudio_title.disabled = true;
			PROJECT_STYLE_VISUALSTUDIO.checked = false;
			PROJECT_STYLE_OFFICE.disabled = true;
			office_title.disabled = true;
			PROJECT_STYLE_OFFICE.checked = false;

			window.external.AddSymbol("LIST_VIEW", false);
			if (window.external.FindSymbol("VIEW_BASE_CLASS") != "CView")
				window.external.AddSymbol("VIEW_BASE_CLASS", "CView");

			PROJECT_STYLE_MFCSTD.checked = true;
			OnProjectStyle();
		}
		else {
			PROJECT_STYLE_EXPLORER.disabled = false;
			explorer_title.disabled = false;
			PROJECT_STYLE_VISUALSTUDIO.disabled = false;
			visualstudio_title.disabled = false;
			PROJECT_STYLE_OFFICE.disabled = false;
			office_title.disabled = false;
		}
	}

	function OnProjectStyle() {
		window.external.AddSymbol("ADV_DOCKING_EXPLORER", false);
		window.external.AddSymbol("ADV_DOCKING_OUTPUT", false);
		window.external.AddSymbol("ADV_DOCKING_PROPERTIES", false);
		window.external.AddSymbol("ADV_DOCKING_NAVIGATION", false);
		window.external.AddSymbol("ADV_DOCKING_CAPTION", false);

		if (!PROJECT_STYLE_EXPLORER.checked) {
			window.external.AddSymbol("PRINTING", true);
			window.external.AddSymbol("LIST_VIEW", false);
			if (window.external.FindSymbol("VIEW_BASE_CLASS") != "CView")
				window.external.AddSymbol("VIEW_BASE_CLASS", "CView");
		}

		if (PROJECT_STYLE_MFCSTD.checked) {
			window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", true);
			window.external.AddSymbol("TOOLBAR_NONE", true);
			window.external.AddSymbol("DOCKING_TOOLBAR", true);
			window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
			window.external.AddSymbol("MENUBAR_TOOLBAR", false);
			window.external.AddSymbol("RIBBON_TOOLBAR", false);

			if (APP_TYPE_MDI.checked) {
				APP_TYPE_TABBED_MDI.checked = false;
				window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CMDIFrameWnd");
			}
			else {
				window.external.AddSymbol("MAIN_FRAME_BASE_CLASS", "CFrameWnd");
			}
			window.external.AddSymbol("CHILD_FRAME_BASE_CLASS", "CMDIChildWnd");

			VISUAL_STYLE_COMBO.value = "DEFMFC_LOOK";
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = true;
			enable_visual_style_switching_label.disabled = true;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = false;
		}

		if (PROJECT_STYLE_EXPLORER.checked) {
			window.external.AddSymbol("PRINTING", false);
			window.external.AddSymbol("LIST_VIEW", true);
			window.external.AddSymbol("OLEDB_RECORD_VIEW", false);
			window.external.AddSymbol("ODBC_RECORD_VIEW", false);

			window.external.AddSymbol("SCROLL_VIEW", false);
			window.external.AddSymbol("FORM_VIEW", false);
			window.external.AddSymbol("TREE_VIEW", false);
			window.external.AddSymbol("RICH_EDIT_VIEW", false);
			window.external.AddSymbol("EDIT_VIEW", false);
			window.external.AddSymbol("HTML_VIEW", false);
			window.external.AddSymbol("HTML_EDITVIEW", false);

			if (window.external.FindSymbol("VIEW_BASE_CLASS") != "CListView") {
				window.external.AddSymbol("VIEW_BASE_CLASS", "CListView");
			}
		}

		if (PROJECT_STYLE_VISUALSTUDIO.checked) {
			window.external.AddSymbol("ADV_DOCKING_EXPLORER", true);
			window.external.AddSymbol("ADV_DOCKING_OUTPUT", true);
			window.external.AddSymbol("ADV_DOCKING_PROPERTIES", true);

			window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
			window.external.AddSymbol("TOOLBAR_NONE", false);
			window.external.AddSymbol("DOCKING_TOOLBAR", false);
			window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
			window.external.AddSymbol("MENUBAR_TOOLBAR", true);
			window.external.AddSymbol("RIBBON_TOOLBAR", false);

			if (APP_TYPE_MDI.checked) {
				APP_TYPE_TABBED_MDI.checked = true;
			}

			window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_VS_2008");
			VISUAL_STYLE_COMBO.value = "VS2008_LOOK";
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = false;
			enable_visual_style_switching_label.disabled = false;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = true;
			window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerVS2008");
		}

		if (PROJECT_STYLE_OFFICE.checked) {
			window.external.AddSymbol("ADV_DOCKING_NAVIGATION", true);
			window.external.AddSymbol("ADV_DOCKING_CAPTION", true);

			window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
			window.external.AddSymbol("TOOLBAR_NONE", false);
			window.external.AddSymbol("DOCKING_TOOLBAR", false);
			window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
			window.external.AddSymbol("MENUBAR_TOOLBAR", false);
			window.external.AddSymbol("RIBBON_TOOLBAR", true);

			if (APP_TYPE_MDI.checked) {
				APP_TYPE_TABBED_MDI.checked = true;
			}

			window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2007_BLUE");
			VISUAL_STYLE_COMBO.value = "OFF2007_BLUE";
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = false;
			enable_visual_style_switching_label.disabled = false;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = true;
			window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2007");
			window.external.AddSymbol("VISUAL_STYLE", "Office2007_LunaBlue");
		}

		ToggleImage();
	}

	function OnAppearance(obj) {
		if (obj.id != "VISUAL_STYLE_COMBO") {
			return;
		}

		var oAppearances = document.all.tags("SELECT").item("VISUAL_STYLE_COMBO");
		if (oAppearances != null) {
			ENABLE_VISUAL_STYLE_SWITCHING.disabled = false;
			enable_visual_style_switching_label.disabled = false;
			ENABLE_VISUAL_STYLE_SWITCHING.checked = true;

			window.external.AddSymbol("VISUAL_MANAGER_WINDOWS_7", false);

			oAppearance = oAppearances.options[oAppearances.selectedIndex];
			var strAppearance = oAppearance.value;
			if (strAppearance == "OFF2003_LOOK") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2003");
				window.external.AddSymbol("USE_VISUAL_STYLE", false);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2003");
				if ((window.external.FindSymbol("RIBBON_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", true);
					window.external.AddSymbol("RIBBON_TOOLBAR", false);
				}
			}
			else if (strAppearance == "VS2005_LOOK") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerVS2005");
				window.external.AddSymbol("USE_VISUAL_STYLE", false);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_VS_2005");
				if ((window.external.FindSymbol("RIBBON_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", true);
					window.external.AddSymbol("RIBBON_TOOLBAR", false);
				}
			}
			else if (strAppearance == "VS2008_LOOK") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerVS2008");
				window.external.AddSymbol("USE_VISUAL_STYLE", false);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_VS_2008");
				if ((window.external.FindSymbol("RIBBON_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", true);
					window.external.AddSymbol("RIBBON_TOOLBAR", false);
				}
			}
			else if (strAppearance == "OFF2007_BLUE") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2007");
				window.external.AddSymbol("VISUAL_STYLE", "Office2007_LunaBlue");
				window.external.AddSymbol("USE_VISUAL_STYLE", true);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2007_BLUE");
				if ((window.external.FindSymbol("MENUBAR_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else if (strAppearance == "OFF2007_BLACK") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2007");
				window.external.AddSymbol("VISUAL_STYLE", "Office2007_ObsidianBlack");
				window.external.AddSymbol("USE_VISUAL_STYLE", true);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2007_BLACK");
				if ((window.external.FindSymbol("MENUBAR_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else if (strAppearance == "OFF2007_SILVER") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2007");
				window.external.AddSymbol("VISUAL_STYLE", "Office2007_Silver");
				window.external.AddSymbol("USE_VISUAL_STYLE", true);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2007_SILVER");
				if ((window.external.FindSymbol("MENUBAR_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else if (strAppearance == "OFF2007_AQUA") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerOffice2007");
				window.external.AddSymbol("VISUAL_STYLE", "Office2007_Aqua");
				window.external.AddSymbol("USE_VISUAL_STYLE", true);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_OFF_2007_AQUA");
				if ((window.external.FindSymbol("MENUBAR_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else if (strAppearance == "WINDOWS_7") {
				window.external.AddSymbol("USE_VISUAL_MANAGER", true);
				window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerWindows7");
				window.external.AddSymbol("USE_VISUAL_STYLE", false);
				window.external.AddSymbol("APPLICATION_LOOK_VALUE", "ID_VIEW_APPLOOK_WINDOWS_7");
				window.external.AddSymbol("VISUAL_MANAGER_WINDOWS_7", true);
				if ((window.external.FindSymbol("MENUBAR_TOOLBAR") == false) && (window.external.FindSymbol("USE_STANDARD_MENU_TOOLBAR") == false)) {
					window.external.AddSymbol("USE_STANDARD_MENU_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_NONE", false);
					window.external.AddSymbol("DOCKING_TOOLBAR", false);
					window.external.AddSymbol("TOOLBAR_STYLE_REBAR", false);
					window.external.AddSymbol("MENUBAR_TOOLBAR", false);
					window.external.AddSymbol("RIBBON_TOOLBAR", true);
				}
			}
			else {
				window.external.AddSymbol("USE_VISUAL_STYLE", false);
				if (PROJECT_STYLE_MFCSTD.checked) {
					window.external.AddSymbol("USE_VISUAL_MANAGER", false);
				}
				else {
					window.external.AddSymbol("USE_VISUAL_MANAGER", true);
					window.external.AddSymbol("VISUAL_MANAGER", "CMFCVisualManagerWindows");
				}

				ENABLE_VISUAL_STYLE_SWITCHING.disabled = true;
				enable_visual_style_switching_label.disabled = true;
				ENABLE_VISUAL_STYLE_SWITCHING.checked = false;
			}
		}
	}

	function OnLang() {
		var oLangs = document.all.tags("SELECT").item("LANGUAGE");
		if (oLangs != null) {
			oLang = oLangs.options[oLangs.selectedIndex];
			var strLCID = oLang.value;

			// fix up the templates path for the locale
			var strCurrentTemplatesPath = window.external.FindSymbol("TEMPLATES_PATH");
			var nIndex = strCurrentTemplatesPath.lastIndexOf("\\");
			var strSubstr = strCurrentTemplatesPath.substr(0, nIndex);
			var strNewTemplatesPath = strSubstr + "\\" + strLCID;
			window.external.AddSymbol("TEMPLATES_PATH", strNewTemplatesPath);

			SetLocaleForResources(strLCID);

			// for any LCID where we want to allow extended characters as  toolbar mnemonics, set
			// the TOOLBAR_EXTCHAR_TRANSLATE symbol to true--currently only Russian LCID applies.
			if (strLCID == "1049") {
				window.external.AddSymbol("TOOLBAR_EXTCHAR_TRANSLATE", true);
			}
			else {
				window.external.AddSymbol("TOOLBAR_EXTCHAR_TRANSLATE", false);
			}
		}
	}

	function ToggleImage() {
		SINGLE_DOC_IMAGE.style.display = "none";
		MULTI_DOC_IMAGE.style.display = "none";
		MULTI_DOC_TABBED_IMAGE.style.display = "none";
		DIALOG_IMAGE.style.display = "none";
		MULTI_TOP_DOC_IMAGE.style.display = "none";
		VISUAL_STUDIO_STYLE.style.display = "none";
		OFFICE_STYLE.style.display = "none";

		if (PROJECT_STYLE_VISUALSTUDIO.checked) {
			VISUAL_STUDIO_STYLE.style.display = "block";
			return;
		}
		if (PROJECT_STYLE_OFFICE.checked) {
			OFFICE_STYLE.style.display = "block";
			return;
		}
		if (APP_TYPE_SDI.checked) {
			SINGLE_DOC_IMAGE.style.display = "block";
			return;
		}
		if (APP_TYPE_MDI.checked) {
			if (APP_TYPE_TABBED_MDI.checked) {
				MULTI_DOC_TABBED_IMAGE.style.display = "block";
				return;
			}
			MULTI_DOC_IMAGE.style.display = "block";
			return;
		}
		if (APP_TYPE_DLG.checked) {
			DIALOG_IMAGE.style.display = "block";
			return;
		}
		if (APP_TYPE_MTLD.checked) {
			MULTI_TOP_DOC_IMAGE.style.display = "block";
		}
	}

	function SetFocus() {
		if (APP_TYPE_SDI.checked) {
			APP_TYPE_SDI.focus();
			return;
		}
		if (APP_TYPE_MDI.checked) {
			APP_TYPE_MDI.focus();
			return;
		}
		if (APP_TYPE_DLG.checked) {
			APP_TYPE_DLG.focus();
			return;
		}
		if (APP_TYPE_MTLD.checked) {
			APP_TYPE_MTLD.focus();
		}
	}

	function OnDHTMLDialogSupport() {
		if (HTML_DIALOG.checked) {
			NO_MFC_CONTROLS.checked = false;
			window.external.AddSymbol("DIALOG_BASE_CLASS", "CDHtmlDialog");
		}
		else {
			window.external.AddSymbol("DIALOG_BASE_CLASS", "CDialogEx");
		}
	}

	function OnMFCControls() {
		if (NO_MFC_CONTROLS.checked)
		{
			HTML_DIALOG.checked = false;
			window.external.AddSymbol("DIALOG_BASE_CLASS", "CDialog");
		}
		else
		{
			window.external.AddSymbol("DIALOG_BASE_CLASS", "CDialogEx");
		}
	}

</script>

<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>

<script id="INCLUDE_COMMON" language="JSCRIPT"></script>

<script>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</script>

